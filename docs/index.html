
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>TIGRAMITE &#8212; Tigramite 4.0 documentation</title>
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="#">Tigramite 4.0 documentation</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="#">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">TIGRAMITE</a></li>
<li><a class="reference internal" href="#tigramite-pcmci-pcmci"><code class="docutils literal notranslate"><span class="pre">tigramite.pcmci</span></code>: PCMCI</a></li>
<li><a class="reference internal" href="#tigramite-independence-tests-conditional-independence-tests"><code class="docutils literal notranslate"><span class="pre">tigramite.independence_tests</span></code>: Conditional independence tests</a></li>
<li><a class="reference internal" href="#module-tigramite.data_processing"><code class="docutils literal notranslate"><span class="pre">tigramite.data_processing</span></code>: Data processing functions</a></li>
<li><a class="reference internal" href="#tigramite-models-time-series-modeling-mediation-and-prediction"><code class="docutils literal notranslate"><span class="pre">tigramite.models</span></code>: Time series modeling, mediation, and prediction</a></li>
<li><a class="reference internal" href="#module-tigramite.plotting"><code class="docutils literal notranslate"><span class="pre">tigramite.plotting</span></code>: Plotting functions</a></li>
<li><a class="reference internal" href="#indices-and-tables">Indices and tables</a></li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/index.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="tigramite">
<h1>TIGRAMITE<a class="headerlink" href="#tigramite" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="https://github.com/jakobrunge/tigramite/">Github repo</a></p>
<p>Tigramite is a causal time series analysis python package. It allows to efficiently reconstruct causal graphs from high-dimensional time series datasets and model the obtained causal dependencies for causal mediation and prediction analyses. Causal discovery is based on linear as well as non-parametric conditional independence tests applicable to discrete or continuously-valued time series. Also includes functions for high-quality plots of the results. Please cite the following papers depending on which method you use:</p>
<ol class="arabic simple">
<li>J. Runge et al. (2018): Detecting Causal Associations in Large Nonlinear Time Series Datasets.
<a class="reference external" href="https://arxiv.org/abs/1702.07007v2">https://arxiv.org/abs/1702.07007v2</a></li>
<li>J. Runge et al. (2015): Identifying causal gateways and mediators in complex spatio-temporal systems.
Nature Communications, 6, 8502.
<a class="reference external" href="http://doi.org/10.1038/ncomms9502">http://doi.org/10.1038/ncomms9502</a></li>
<li>J. Runge (2015): Quantifying information transfer and mediation along causal pathways in complex systems.
Phys. Rev. E, 92(6), 62829.
<a class="reference external" href="http://doi.org/10.1103/PhysRevE.92.062829">http://doi.org/10.1103/PhysRevE.92.062829</a></li>
<li>J. Runge (2018): Conditional Independence Testing Based on a Nearest-Neighbor Estimator of Conditional Mutual Information.
In Proceedings of the 21st International Conference on Artificial Intelligence and Statistics.
<a class="reference external" href="http://proceedings.mlr.press/v84/runge18a.html">http://proceedings.mlr.press/v84/runge18a.html</a></li>
<li>J. Runge (2018): Causal Network Reconstruction from Time Series: From Theoretical Assumptions to Practical Estimation.
Chaos: An Interdisciplinary Journal of Nonlinear Science 28 (7): 075310.
<a class="reference external" href="https://aip.scitation.org/doi/10.1063/1.5025050">https://aip.scitation.org/doi/10.1063/1.5025050</a></li>
</ol>
<div class="toctree-wrapper compound">
</div>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tigramite.pcmci.PCMCI" title="tigramite.pcmci.PCMCI"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tigramite.pcmci.PCMCI</span></code></a>(dataframe,&nbsp;cond_ind_test)</td>
<td>PCMCI causal discovery for time series datasets.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tigramite.independence_tests.CondIndTest" title="tigramite.independence_tests.CondIndTest"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tigramite.independence_tests.CondIndTest</span></code></a>([…])</td>
<td>Base class of conditional independence tests.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tigramite.independence_tests.ParCorr" title="tigramite.independence_tests.ParCorr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tigramite.independence_tests.ParCorr</span></code></a>(**kwargs)</td>
<td>Partial correlation test.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tigramite.independence_tests.GPDC" title="tigramite.independence_tests.GPDC"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tigramite.independence_tests.GPDC</span></code></a>([…])</td>
<td>GPDC conditional independence test based on Gaussian processes and     distance correlation.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tigramite.independence_tests.CMIknn" title="tigramite.independence_tests.CMIknn"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tigramite.independence_tests.CMIknn</span></code></a>([knn,&nbsp;…])</td>
<td>Conditional mutual information test based on nearest-neighbor estimator.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tigramite.independence_tests.CMIsymb" title="tigramite.independence_tests.CMIsymb"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tigramite.independence_tests.CMIsymb</span></code></a>([…])</td>
<td>Conditional mutual information test based on discrete estimator.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tigramite.independence_tests.RCOT" title="tigramite.independence_tests.RCOT"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tigramite.independence_tests.RCOT</span></code></a>([num_f,&nbsp;…])</td>
<td>Randomized Conditional Correlation Test.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#module-tigramite.data_processing" title="tigramite.data_processing"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tigramite.data_processing</span></code></a></td>
<td>Tigramite data processing functions.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tigramite.models.Models" title="tigramite.models.Models"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tigramite.models.Models</span></code></a>(dataframe,&nbsp;model[,&nbsp;…])</td>
<td>Base class for time series models.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tigramite.models.LinearMediation" title="tigramite.models.LinearMediation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tigramite.models.LinearMediation</span></code></a>(dataframe)</td>
<td>Linear mediation analysis for time series models.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tigramite.models.Prediction" title="tigramite.models.Prediction"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tigramite.models.Prediction</span></code></a>(dataframe,&nbsp;…)</td>
<td>Prediction class for time series models.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#module-tigramite.plotting" title="tigramite.plotting"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tigramite.plotting</span></code></a></td>
<td>Tigramite plotting package.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="tigramite-pcmci-pcmci">
<h1><code class="xref py py-mod docutils literal notranslate"><span class="pre">tigramite.pcmci</span></code>: PCMCI<a class="headerlink" href="#tigramite-pcmci-pcmci" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="tigramite.pcmci.PCMCI">
<em class="property">class </em><code class="descclassname">tigramite.pcmci.</code><code class="descname">PCMCI</code><span class="sig-paren">(</span><em>dataframe</em>, <em>cond_ind_test</em>, <em>selected_variables=None</em>, <em>verbosity=0</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.pcmci.PCMCI" title="Permalink to this definition">¶</a></dt>
<dd><p>PCMCI causal discovery for time series datasets.</p>
<p>PCMCI is a 2-step causal discovery method for large-scale time series
datasets. The first step is a condition-selection followed by the MCI
conditional independence test. The implementation is based on Algorithms 1
and 2 in <a class="footnote-reference" href="#id5" id="id1">[1]</a>.</p>
<p>PCMCI allows:</p>
<blockquote>
<div><ul class="simple">
<li>different conditional independence test statistics adapted to
continuously-valued or discrete data, and different assumptions about
linear or nonlinear dependencies</li>
<li>hyperparameter optimization</li>
<li>easy parallelization</li>
<li>handling of masked time series data</li>
<li>false discovery control and confidence interval estimation</li>
</ul>
</div></blockquote>
<p class="rubric">Notes</p>
<a class="reference internal image-reference" href="_images/mci_schematic.png"><img alt="_images/mci_schematic.png" src="_images/mci_schematic.png" style="width: 200pt;" /></a>
<p>The PCMCI causal discovery method is comprehensively described in <a class="footnote-reference" href="#id5" id="id2">[1]</a>,
where also analytical and numerical results are presented. Here we briefly
summarize the method.</p>
<p>In the PCMCI framework, the dependency structure of a set of
time series variables is represented in a <em>time series graph</em> as shown in
the Figure. The nodes of a time series graph are defined as the variables at
different times and a link exists if two lagged variables are <em>not</em>
conditionally independent given the past of the whole process. Assuming
stationarity, the links are repeated in time. The parents
<img class="math" src="_images/math/44ad79f4db8277d12b1a6f5def2d30122c89b9b0.png" alt="\mathcal{P}"/> of a variable are defined as the set of all nodes with a
link towards it (blue and red boxes in Figure). Estimating these parents
directly by testing for conditional independence on the whole past is
problematic due to high-dimensionality and because conditioning on
irrelevant variables leads to biases <a class="footnote-reference" href="#id5" id="id3">[1]</a>.</p>
<p>PCMCI estimates causal links by a two-step procedure:</p>
<ol class="arabic">
<li><p class="first">Condition-selection: For each variable <img class="math" src="_images/math/6b21e0b0899a0d2879d3b8019087fa630bab4ea2.png" alt="j"/>, estimate a
<em>superset</em>  of parents <img class="math" src="_images/math/f75f28dbcbec776fbe031f8ac923f83f9260bd8a.png" alt="\tilde{\mathcal{P}}(X^j_t)"/> with the
iterative PC1 algorithm , implemented as <code class="docutils literal notranslate"><span class="pre">run_pc_stable</span></code>.</p>
</li>
<li><p class="first"><em>Momentary conditional independence</em> (MCI)</p>
<div class="math">
<p><img src="_images/math/e655092ec45224f09927d0ed9e6fcdfbddb67754.png" alt="X^i_{t-\tau} ~\perp~ X^j_{t} ~|~ \tilde{\mathcal{P}}(X^j_t),
\tilde{\mathcal{P}}(X^i_{t-{\tau}})"/></p>
</div></li>
</ol>
<p>here implemented as <code class="docutils literal notranslate"><span class="pre">run_mci</span></code>. The condition-selection step reduces the
dimensionality and avoids conditioning on irrelevant variables.</p>
<p>PCMCI can be flexibly combined with any kind of conditional independence
test statistic adapted to the kind of data (continuous or discrete) and its
assumed dependency structure. Currently, implemented in Tigramite are
ParCorr as a linear test, GPACE allowing nonlinear additive dependencies,
and CMI with different estimators making no assumptions about the
dependencies. The classes in <code class="docutils literal notranslate"><span class="pre">tigramite.independence_tests</span></code> also handle
masked data.</p>
<p>The main free parameters of PCMCI (in addition to free parameters of the
conditional independence test statistic) are the maximum time delay
<img class="math" src="_images/math/12535500db0213985b2cce27db85468b60985da0.png" alt="\tau_{\max}"/> (<code class="docutils literal notranslate"><span class="pre">tau_max</span></code>) and the significance threshold in the
condition- selection step <img class="math" src="_images/math/877d234f4cec6974ce218fc2e975a486a7972dfd.png" alt="\alpha"/> (<code class="docutils literal notranslate"><span class="pre">pc_alpha</span></code>). The maximum time
delay depends on the application and should be chosen according to the
maximum causal time lag expected in the complex system. We recommend a
rather large choice that includes peaks in the lagged cross-correlation
function (or a more general measure). <img class="math" src="_images/math/877d234f4cec6974ce218fc2e975a486a7972dfd.png" alt="\alpha"/> should not be seen as a
significance test level in the condition-selection step since the iterative
hypothesis tests do not allow for a precise confidence level. <img class="math" src="_images/math/877d234f4cec6974ce218fc2e975a486a7972dfd.png" alt="\alpha"/>
rather takes the role of a regularization parameter in model-selection
techniques. The conditioning sets <img class="math" src="_images/math/2fc62c02be8e341b7c32727e07b633086e70ba8a.png" alt="\tilde{\mathcal{P}}"/>  should
include the true parents and at the same time be small in size to reduce the
estimation dimension of the MCI test and improve its power. But including
the true  parents is typically more important. If a list of values is given
or <code class="docutils literal notranslate"><span class="pre">pc_alpha=None</span></code>, <img class="math" src="_images/math/877d234f4cec6974ce218fc2e975a486a7972dfd.png" alt="\alpha"/> is optimized using model selection
criteria.</p>
<p>Further optional parameters are discussed in <a class="footnote-reference" href="#id5" id="id4">[1]</a>.</p>
<p class="rubric">References</p>
<table class="docutils footnote" frame="void" id="id5" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id2">2</a>, <a class="fn-backref" href="#id3">3</a>, <a class="fn-backref" href="#id4">4</a>, <a class="fn-backref" href="#id6">5</a>, <a class="fn-backref" href="#id7">6</a>, <a class="fn-backref" href="#id8">7</a>, <a class="fn-backref" href="#id9">8</a>, <a class="fn-backref" href="#id10">9</a>, <a class="fn-backref" href="#id11">10</a>, <a class="fn-backref" href="#id15">11</a>, <a class="fn-backref" href="#id21">12</a>, <a class="fn-backref" href="#id22">13</a>, <a class="fn-backref" href="#id23">14</a>, <a class="fn-backref" href="#id24">15</a>, <a class="fn-backref" href="#id25">16</a>, <a class="fn-backref" href="#id29">17</a>)</em> J. Runge et al. (2018): Detecting Causal Associations in Large
Nonlinear Time Series Datasets.
<a class="reference external" href="https://arxiv.org/abs/1702.07007v2">https://arxiv.org/abs/1702.07007v2</a></td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tigramite.pcmci</span> <span class="k">import</span> <span class="n">PCMCI</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tigramite.independence_tests</span> <span class="k">import</span> <span class="n">ParCorr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">tigramite.data_processing</span> <span class="k">as</span> <span class="nn">pp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Example process to play around with</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Each key refers to a variable and the incoming links are supplied as a</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># list of format [((driver, lag), coeff), ...]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">links_coeffs</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">[((</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="mf">0.8</span><span class="p">)],</span>
<span class="go">                    1: [((1, -1), 0.8), ((0, -1), 0.5)],</span>
<span class="go">                    2: [((2, -1), 0.8), ((1, -2), -0.6)]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">var_process</span><span class="p">(</span><span class="n">links_coeffs</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Data must be array of shape (time, variables)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1000, 3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataframe</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cond_ind_test</span> <span class="o">=</span> <span class="n">ParCorr</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pcmci</span> <span class="o">=</span> <span class="n">PCMCI</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">cond_ind_test</span><span class="o">=</span><span class="n">cond_ind_test</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">pcmci</span><span class="o">.</span><span class="n">run_pcmci</span><span class="p">(</span><span class="n">tau_max</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pc_alpha</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pcmci</span><span class="o">.</span><span class="n">_print_significant_links</span><span class="p">(</span><span class="n">p_matrix</span><span class="o">=</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;p_matrix&#39;</span><span class="p">],</span>
<span class="go">                                     val_matrix=results[&#39;val_matrix&#39;],</span>
<span class="go">                                     alpha_level=0.05)</span>
<span class="go">## Significant parents at alpha = 0.05:</span>
<span class="go">    Variable 0 has 1 parent(s):</span>
<span class="go">        (0 -1): pval = 0.00000 | val = 0.623</span>
<span class="go">    Variable 1 has 2 parent(s):</span>
<span class="go">        (1 -1): pval = 0.00000 | val = 0.601</span>
<span class="go">        (0 -1): pval = 0.00000 | val = 0.487</span>
<span class="go">    Variable 2 has 2 parent(s):</span>
<span class="go">        (2 -1): pval = 0.00000 | val = 0.597</span>
<span class="go">        (1 -2): pval = 0.00000 | val = -0.511</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dataframe</strong> (<em>data object</em>) – This is the Tigramite dataframe object. It has the attributes
dataframe.values yielding a numpy array of shape (observations T,
variables N) and optionally a mask of  the same shape.</li>
<li><strong>cond_ind_test</strong> (<em>conditional independence test object</em>) – <p>This can be ParCorr or other classes from the tigramite package or an
external test passed as a callable. This test can be based on the class
tigramite.independence_tests.CondIndTest. If a callable is passed, it
must have the signature:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CondIndTest</span><span class="p">():</span>
    <span class="c1"># with attributes</span>
    <span class="c1"># * measure : str</span>
    <span class="c1">#   name of the test</span>
    <span class="c1"># * use_mask : bool</span>
    <span class="c1">#   whether the mask should be used</span>

    <span class="c1"># and functions</span>
    <span class="c1"># * run_test(X, Y, Z, tau_max) : where X,Y,Z are of the form</span>
    <span class="c1">#   X = [(var, -tau)]  for non-negative integers var and tau</span>
    <span class="c1">#   specifying the variable and time lag</span>
    <span class="c1">#   return (test statistic value, p-value)</span>
    <span class="c1"># * set_dataframe(dataframe) : set dataframe object</span>

    <span class="c1"># optionally also</span>

    <span class="c1"># * get_model_selection_criterion(j, parents) : required if</span>
    <span class="c1">#   pc_alpha parameter is to be optimized. Here j is the</span>
    <span class="c1">#   variable index and parents a list [(var, -tau), ...]</span>
    <span class="c1">#   return score for model selection</span>
    <span class="c1"># * get_confidence(X, Y, Z, tau_max) : required for</span>
    <span class="c1">#   return_confidence=True</span>
    <span class="c1">#   estimate confidence interval after run_test was called</span>
    <span class="c1">#   return (lower bound, upper bound)</span>
</pre></div>
</div>
</li>
<li><strong>selected_variables</strong> (<em>list of integers</em><em>, </em><em>optional</em><em> (</em><em>default: range</em><em>(</em><em>N</em><em>)</em><em>)</em>) – Specify to estimate parents only for selected variables. If None is
passed, parents are estimated for all variables.</li>
<li><strong>verbosity</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 0</em><em>)</em>) – Verbose levels 0, 1, …</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="tigramite.pcmci.PCMCI.all_parents">
<code class="descname">all_parents</code><a class="headerlink" href="#tigramite.pcmci.PCMCI.all_parents" title="Permalink to this definition">¶</a></dt>
<dd><p><em>dictionary</em> – Dictionary of form {0:[(0, -1), (3, -2), …], 1:[], …} containing the
conditioning-parents estimated with PC algorithm.</p>
</dd></dl>

<dl class="attribute">
<dt id="tigramite.pcmci.PCMCI.val_min">
<code class="descname">val_min</code><a class="headerlink" href="#tigramite.pcmci.PCMCI.val_min" title="Permalink to this definition">¶</a></dt>
<dd><p><em>dictionary</em> – Dictionary of form val_min[j][(i, -tau)] = float
containing the minimum test statistic value for each link estimated in
the PC algorithm.</p>
</dd></dl>

<dl class="attribute">
<dt id="tigramite.pcmci.PCMCI.p_max">
<code class="descname">p_max</code><a class="headerlink" href="#tigramite.pcmci.PCMCI.p_max" title="Permalink to this definition">¶</a></dt>
<dd><p><em>dictionary</em> – Dictionary of form p_max[j][(i, -tau)] = float containing the maximum
p-value for each link estimated in the PC algorithm.</p>
</dd></dl>

<dl class="attribute">
<dt id="tigramite.pcmci.PCMCI.iterations">
<code class="descname">iterations</code><a class="headerlink" href="#tigramite.pcmci.PCMCI.iterations" title="Permalink to this definition">¶</a></dt>
<dd><p><em>dictionary</em> – Dictionary containing further information on algorithm steps.</p>
</dd></dl>

<dl class="attribute">
<dt id="tigramite.pcmci.PCMCI.N">
<code class="descname">N</code><a class="headerlink" href="#tigramite.pcmci.PCMCI.N" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em> – Number of variables.</p>
</dd></dl>

<dl class="attribute">
<dt id="tigramite.pcmci.PCMCI.T">
<code class="descname">T</code><a class="headerlink" href="#tigramite.pcmci.PCMCI.T" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em> – Time series sample length.</p>
</dd></dl>

<dl class="method">
<dt id="tigramite.pcmci.PCMCI.get_corrected_pvalues">
<code class="descname">get_corrected_pvalues</code><span class="sig-paren">(</span><em>p_matrix</em>, <em>fdr_method='fdr_bh'</em>, <em>exclude_contemporaneous=True</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.pcmci.PCMCI.get_corrected_pvalues" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns p-values corrected for multiple testing.</p>
<p>Currently implemented is Benjamini-Hochberg False Discovery Rate
method. Correction is performed either among all links if
exclude_contemporaneous==False, or only among lagged links.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>p_matrix</strong> (<em>array-like</em>) – Matrix of p-values. Must be of shape (N, N, tau_max + 1).</li>
<li><strong>fdr_method</strong> (<em>str</em><em>, </em><em>optional</em><em> (</em><em>default: 'fdr_bh'</em><em>)</em>) – Correction method, currently implemented is Benjamini-Hochberg
False Discovery Rate method.</li>
<li><strong>exclude_contemporaneous</strong> (<em>bool</em><em>, </em><em>optional</em><em> (</em><em>default: True</em><em>)</em>) – Whether to include contemporaneous links in correction.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>q_matrix</strong> – Matrix of shape (N, N, tau_max + 1) containing corrected p-values.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array-like</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tigramite.pcmci.PCMCI.get_lagged_dependencies">
<code class="descname">get_lagged_dependencies</code><span class="sig-paren">(</span><em>selected_links=None</em>, <em>tau_min=0</em>, <em>tau_max=1</em>, <em>parents=None</em>, <em>max_conds_py=None</em>, <em>max_conds_px=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.pcmci.PCMCI.get_lagged_dependencies" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns matrix of lagged dependence measure values.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>selected_links</strong> (<em>dict</em><em> or </em><em>None</em>) – Dictionary of form {0:[(0, -1), (3, -2), …], 1:[], …}
specifying whether only selected links should be tested. If None is
passed, all links are tested</li>
<li><strong>tau_min</strong> (<em>int</em><em>, </em><em>default: 0</em>) – Minimum time lag.</li>
<li><strong>tau_max</strong> (<em>int</em><em>, </em><em>default: 1</em>) – Maximum time lag. Must be larger or equal to tau_min.</li>
<li><strong>parents</strong> (<em>dict</em><em> or </em><em>None</em>) – Dictionary of form {0:[(0, -1), (3, -2), …], 1:[], …}
specifying the conditions for each variable. If None is
passed, no conditions are used.</li>
<li><strong>max_conds_py</strong> (<em>int</em><em> or </em><em>None</em>) – Maximum number of conditions from parents of Y to use. If None is
passed, this number is unrestricted.</li>
<li><strong>max_conds_px</strong> (<em>int</em><em> or </em><em>None</em>) – Maximum number of conditions from parents of X to use. If None is
passed, this number is unrestricted.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>val_matrix</strong> – The matrix of shape (N, N, tau_max+1) containing the lagged
dependencies.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tigramite.pcmci.PCMCI.print_results">
<code class="descname">print_results</code><span class="sig-paren">(</span><em>return_dict</em>, <em>alpha_level=0.05</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.pcmci.PCMCI.print_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints significant parents from output of MCI or PCMCI algorithms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>return_dict</strong> (<em>dict</em>) – <dl class="docutils">
<dt>Dictionary of return values, containing keys</dt>
<dd><ul class="first last">
<li>’p_matrix’</li>
<li>’val_matrix’</li>
<li>’conf_matrix’</li>
</ul>
</dd>
</dl>
<p>’q_matrix’ can also be included in keys, but is not necessary.</p>
</li>
<li><strong>alpha_level</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 0.05</em><em>)</em>) – Significance level.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tigramite.pcmci.PCMCI.print_significant_links">
<code class="descname">print_significant_links</code><span class="sig-paren">(</span><em>p_matrix</em>, <em>val_matrix</em>, <em>conf_matrix=None</em>, <em>q_matrix=None</em>, <em>alpha_level=0.05</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.pcmci.PCMCI.print_significant_links" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints significant parents.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>alpha_level</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 0.05</em><em>)</em>) – Significance level.</li>
<li><strong>p_matrix</strong> (<em>array-like</em>) – Must be of shape (N, N, tau_max + 1).</li>
<li><strong>val_matrix</strong> (<em>array-like</em>) – Must be of shape (N, N, tau_max + 1).</li>
<li><strong>q_matrix</strong> (<em>array-like</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Adjusted p-values. Must be of shape (N, N, tau_max + 1).</li>
<li><strong>conf_matrix</strong> (<em>array-like</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Matrix of confidence intervals of shape (N, N, tau_max+1, 2)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tigramite.pcmci.PCMCI.return_significant_parents">
<code class="descname">return_significant_parents</code><span class="sig-paren">(</span><em>pq_matrix</em>, <em>val_matrix</em>, <em>alpha_level=0.05</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.pcmci.PCMCI.return_significant_parents" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns list of significant parents as well as a boolean matrix.</p>
<p>Significance based on p-matrix, or q-value matrix with corrected
p-values.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pq_matrix</strong> (<em>array-like</em>) – p-matrix, or q-value matrix with corrected p-values. Must be of
shape (N, N, tau_max + 1).</li>
<li><strong>val_matrix</strong> (<em>array-like</em>) – Matrix of test statistic values. Must be of shape (N, N, tau_max +
1).</li>
<li><strong>alpha_level</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 0.05</em><em>)</em>) – Significance level.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>all_parents</strong> (<em>dict</em>) – Dictionary of form {0:[(0, -1), (3, -2), …], 1:[], …}
containing estimated parents.</li>
<li><strong>link_matrix</strong> (<em>array, shape [N, N, tau_max+1]</em>) – Boolean array with True entries for significant links at alpha_level</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tigramite.pcmci.PCMCI.run_mci">
<code class="descname">run_mci</code><span class="sig-paren">(</span><em>selected_links=None</em>, <em>tau_min=0</em>, <em>tau_max=1</em>, <em>parents=None</em>, <em>max_conds_py=None</em>, <em>max_conds_px=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.pcmci.PCMCI.run_mci" title="Permalink to this definition">¶</a></dt>
<dd><p>MCI conditional independence tests.</p>
<p>Implements the MCI test (Algorithm 2 in <a class="footnote-reference" href="#id5" id="id6">[1]</a>). Returns the matrices of
test statistic values,  p-values, and confidence intervals.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>selected_links</strong> (<em>dict</em><em> or </em><em>None</em>) – Dictionary of form {0:all_parents (3, -2), …], 1:[], …}
specifying whether only selected links should be tested. If None is
passed, all links are tested</li>
<li><strong>tau_min</strong> (<em>int</em><em>, </em><em>default: 0</em>) – Minimum time lag to test. Note that zero-lags are undirected.</li>
<li><strong>tau_max</strong> (<em>int</em><em>, </em><em>default: 1</em>) – Maximum time lag. Must be larger or equal to tau_min.</li>
<li><strong>parents</strong> (<em>dict</em><em> or </em><em>None</em>) – Dictionary of form {0:[(0, -1), (3, -2), …], 1:[], …}
specifying the conditions for each variable. If None is
passed, no conditions are used.</li>
<li><strong>max_conds_py</strong> (<em>int</em><em> or </em><em>None</em>) – Maximum number of conditions of Y to use. If None is passed, this
number is unrestricted.</li>
<li><strong>max_conds_px</strong> (<em>int</em><em> or </em><em>None</em>) – Maximum number of conditions of Z to use. If None is passed, this
number is unrestricted.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>results</strong> – {‘val_matrix’:val_matrix, ‘p_matrix’:p_matrix} are always returned
and optionally conf_matrix which is of shape [N, N, tau_max+1,2]</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dictionary of arrays of shape [N, N, tau_max+1]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tigramite.pcmci.PCMCI.run_pc_stable">
<code class="descname">run_pc_stable</code><span class="sig-paren">(</span><em>selected_links=None</em>, <em>tau_min=1</em>, <em>tau_max=1</em>, <em>save_iterations=False</em>, <em>pc_alpha=0.2</em>, <em>max_conds_dim=None</em>, <em>max_combinations=1</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.pcmci.PCMCI.run_pc_stable" title="Permalink to this definition">¶</a></dt>
<dd><p>PC algorithm for estimating parents of all variables.</p>
<p>Parents are made available as self.all_parents</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>selected_links</strong> (<em>dict</em><em> or </em><em>None</em>) – Dictionary of form {0:[(0, -1), (3, -2), …], 1:[], …}
specifying whether only selected links should be tested. If None is
passed, all links are tested</li>
<li><strong>tau_min</strong> (<em>int</em><em>, </em><em>default: 1</em>) – Minimum time lag to test. Useful for multi-step ahead predictions.
Must be greater zero.</li>
<li><strong>tau_max</strong> (<em>int</em><em>, </em><em>default: 1</em>) – Maximum time lag. Must be larger or equal to tau_min.</li>
<li><strong>save_iterations</strong> (<em>bool</em><em>, </em><em>default: False</em>) – Whether to save iteration step results such as conditions used.</li>
<li><strong>pc_alpha</strong> (<em>float</em><em> or </em><em>list of floats</em><em>, </em><em>default: 0.2</em>) – Significance level in algorithm. If a list or None is passed, the
pc_alpha level is optimized for every variable across the given
pc_alpha values using the score computed in
cond_ind_test.get_model_selection_criterion()</li>
<li><strong>max_conds_dim</strong> (<em>int</em><em> or </em><em>None</em>) – Maximum number of conditions to test. If None is passed, this number
is unrestricted.</li>
<li><strong>max_combinations</strong> (<em>int</em><em>, </em><em>default: 1</em>) – Maximum number of combinations of conditions of current cardinality
to test. Defaults to 1 for PC_1 algorithm. For original PC algorithm
a larger number, such as 10, can be used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>all_parents</strong> – Dictionary of form {0:[(0, -1), (3, -2), …], 1:[], …}
containing estimated parents.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tigramite.pcmci.PCMCI.run_pcmci">
<code class="descname">run_pcmci</code><span class="sig-paren">(</span><em>selected_links=None</em>, <em>tau_min=0</em>, <em>tau_max=1</em>, <em>save_iterations=False</em>, <em>pc_alpha=0.05</em>, <em>max_conds_dim=None</em>, <em>max_combinations=1</em>, <em>max_conds_py=None</em>, <em>max_conds_px=None</em>, <em>fdr_method='none'</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.pcmci.PCMCI.run_pcmci" title="Permalink to this definition">¶</a></dt>
<dd><p>Run full PCMCI causal discovery for time series datasets.</p>
<p>Wrapper around PC-algorithm function and MCI function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>selected_links</strong> (<em>dict</em><em> or </em><em>None</em>) – Dictionary of form {0:all_parents (3, -2), …], 1:[], …}
specifying whether only selected links should be tested. If None is
passed, all links are tested</li>
<li><strong>tau_min</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 0</em><em>)</em>) – Minimum time lag to test. Note that zero-lags are undirected.</li>
<li><strong>tau_max</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 1</em><em>)</em>) – Maximum time lag. Must be larger or equal to tau_min.</li>
<li><strong>save_iterations</strong> (<em>bool</em><em>, </em><em>optional</em><em> (</em><em>default: False</em><em>)</em>) – Whether to save iteration step results such as conditions used.</li>
<li><strong>pc_alpha</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 0.05</em><em>)</em>) – Significance level in algorithm.</li>
<li><strong>max_conds_dim</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Maximum number of conditions to test. If None is passed, this number
is unrestricted.</li>
<li><strong>max_combinations</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 1</em><em>)</em>) – Maximum number of combinations of conditions of current cardinality
to test. Defaults to 1 for PC_1 algorithm. For original PC algorithm
a larger number, such as 10, can be used.</li>
<li><strong>max_conds_py</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Maximum number of conditions of Y to use. If None is passed, this
number is unrestricted.</li>
<li><strong>max_conds_px</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Maximum number of conditions of Z to use. If None is passed, this
number is unrestricted.</li>
<li><strong>fdr_method</strong> (<em>str</em><em>, </em><em>optional</em><em> (</em><em>default: 'none'</em><em>)</em>) – Correction method, default is Benjamini-Hochberg False Discovery
Rate method.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>results</strong> – {‘val_matrix’:val_matrix, ‘p_matrix’:p_matrix} are always returned
and optionally q_matrix and conf_matrix which is of shape
[N, N, tau_max+1,2]</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dictionary of arrays of shape [N, N, tau_max+1]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="tigramite-independence-tests-conditional-independence-tests">
<h1><code class="xref py py-mod docutils literal notranslate"><span class="pre">tigramite.independence_tests</span></code>: Conditional independence tests<a class="headerlink" href="#tigramite-independence-tests-conditional-independence-tests" title="Permalink to this headline">¶</a></h1>
<p>Base class:</p>
<dl class="class">
<dt id="tigramite.independence_tests.CondIndTest">
<em class="property">class </em><code class="descclassname">tigramite.independence_tests.</code><code class="descname">CondIndTest</code><span class="sig-paren">(</span><em>mask_type=None</em>, <em>significance='analytic'</em>, <em>fixed_thres=0.1</em>, <em>sig_samples=1000</em>, <em>sig_blocklength=None</em>, <em>confidence=None</em>, <em>conf_lev=0.9</em>, <em>conf_samples=100</em>, <em>conf_blocklength=None</em>, <em>recycle_residuals=False</em>, <em>verbosity=0</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.independence_tests.CondIndTest" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class of conditional independence tests.</p>
<p>Provides useful general functions for different independence tests such as
shuffle significance testing and bootstrap confidence estimation. Also
handles masked samples. Other test classes can inherit from this class.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>mask_type</strong> (<em>str</em><em>, </em><em>optional</em><em> (</em><em>default = None</em><em>)</em>) – Must be in {‘y’,’x’,’z’,’xy’,’xz’,’yz’,’xyz’}
Masking mode: Indicators for which variables in the dependence measure
I(X; Y | Z) the samples should be masked. If None, ‘y’ is used, which
excludes all time slices containing masked samples in Y. Explained in
<a class="footnote-reference" href="#id5" id="id7">[1]</a>.</li>
<li><strong>significance</strong> (<em>str</em><em>, </em><em>optional</em><em> (</em><em>default: 'analytic'</em><em>)</em>) – Type of significance test to use. In this package ‘analytic’,
‘fixed_thres’ and ‘shuffle_test’ are available.</li>
<li><strong>fixed_thres</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 0.1</em><em>)</em>) – If significance is ‘fixed_thres’, this specifies the threshold for the
absolute value of the dependence measure.</li>
<li><strong>sig_samples</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 1000</em><em>)</em>) – Number of samples for shuffle significance test.</li>
<li><strong>sig_blocklength</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Block length for block-shuffle significance test. If None, the
block length is determined from the decay of the autocovariance as
explained in <a class="footnote-reference" href="#id5" id="id8">[1]</a>.</li>
<li><strong>confidence</strong> (<em>str</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Specify type of confidence estimation. If False, numpy.nan is returned.
‘bootstrap’ can be used with any test, for ParCorr also ‘analytic’ is
implemented.</li>
<li><strong>conf_lev</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 0.9</em><em>)</em>) – Two-sided confidence interval.</li>
<li><strong>conf_samples</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 100</em><em>)</em>) – Number of samples for bootstrap.</li>
<li><strong>conf_blocklength</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Block length for block-bootstrap. If None, the block length is
determined from the decay of the autocovariance as explained in <a class="footnote-reference" href="#id5" id="id9">[1]</a>.</li>
<li><strong>recycle_residuals</strong> (<em>bool</em><em>, </em><em>optional</em><em> (</em><em>default: False</em><em>)</em>) – Specifies whether residuals should be stored. This may be faster, but
can cost considerable memory.</li>
<li><strong>verbosity</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 0</em><em>)</em>) – Level of verbosity.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tigramite.independence_tests.CondIndTest.get_analytic_confidence">
<code class="descname">get_analytic_confidence</code><span class="sig-paren">(</span><em>value</em>, <em>df</em>, <em>conf_lev</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.independence_tests.CondIndTest.get_analytic_confidence" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class assumption that this is not implemented.  Concrete classes
should override when possible.</p>
</dd></dl>

<dl class="method">
<dt id="tigramite.independence_tests.CondIndTest.get_analytic_significance">
<code class="descname">get_analytic_significance</code><span class="sig-paren">(</span><em>value</em>, <em>T</em>, <em>dim</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.independence_tests.CondIndTest.get_analytic_significance" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class assumption that this is not implemented.  Concrete classes
should override when possible.</p>
</dd></dl>

<dl class="method">
<dt id="tigramite.independence_tests.CondIndTest.get_bootstrap_confidence">
<code class="descname">get_bootstrap_confidence</code><span class="sig-paren">(</span><em>array</em>, <em>xyz</em>, <em>dependence_measure=None</em>, <em>conf_samples=100</em>, <em>conf_blocklength=None</em>, <em>conf_lev=0.95</em>, <em>verbosity=0</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.independence_tests.CondIndTest.get_bootstrap_confidence" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform bootstrap confidence interval estimation.</p>
<p>With conf_blocklength &gt; 1 or None a block-bootstrap is performed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>array</strong> (<em>array-like</em>) – data array with X, Y, Z in rows and observations in columns</li>
<li><strong>xyz</strong> (<em>array of ints</em>) – XYZ identifier array of shape (dim,).</li>
<li><strong>dependence_measure</strong> (<em>function</em><em> (</em><em>default = self.get_dependence_measure</em><em>)</em>) – Dependence measure function must be of form
dependence_measure(array, xyz) and return a numeric value</li>
<li><strong>conf_lev</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 0.9</em><em>)</em>) – Two-sided confidence interval.</li>
<li><strong>conf_samples</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 100</em><em>)</em>) – Number of samples for bootstrap.</li>
<li><strong>conf_blocklength</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Block length for block-bootstrap. If None, the block length is
determined from the decay of the autocovariance as explained in
<a class="footnote-reference" href="#id5" id="id10">[1]</a>.</li>
<li><strong>verbosity</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 0</em><em>)</em>) – Levelof verbosity.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>(conf_lower, conf_upper)</strong> – Upper and lower confidence bound of confidence interval.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Tuple of floats</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tigramite.independence_tests.CondIndTest.get_confidence">
<code class="descname">get_confidence</code><span class="sig-paren">(</span><em>X</em>, <em>Y</em>, <em>Z=None</em>, <em>tau_max=0</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.independence_tests.CondIndTest.get_confidence" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform confidence interval estimation.</p>
<p>Calls the dependence measure and confidence test functions. The child
classes can specify a function get_dependence_measure and
get_analytic_confidence or get_bootstrap_confidence. If confidence is
False, (numpy.nan, numpy.nan) is returned.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Y</strong><strong>, </strong><strong>Z</strong> (<em>X</em><em>,</em>) – X,Y,Z are of the form [(var, -tau)], where var specifies the
variable index and tau the time lag.</li>
<li><strong>tau_max</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 0</em><em>)</em>) – Maximum time lag. This may be used to make sure that estimates for
different lags in X, Z, all have the same sample size.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>(conf_lower, conf_upper)</strong> – Upper and lower confidence bound of confidence interval.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Tuple of floats</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tigramite.independence_tests.CondIndTest.get_dependence_measure">
<code class="descname">get_dependence_measure</code><span class="sig-paren">(</span><em>array</em>, <em>xyz</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.independence_tests.CondIndTest.get_dependence_measure" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract function that all concrete classes must instantiate.</p>
</dd></dl>

<dl class="method">
<dt id="tigramite.independence_tests.CondIndTest.get_fixed_thres_significance">
<code class="descname">get_fixed_thres_significance</code><span class="sig-paren">(</span><em>value</em>, <em>fixed_thres</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.independence_tests.CondIndTest.get_fixed_thres_significance" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns signficance for thresholding test.</p>
<p>Returns 0 if numpy.abs(value) is smaller than fixed_thres and 1 else.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>value</strong> (<em>number</em>) – Value of test statistic for unshuffled estimate.</li>
<li><strong>fixed_thres</strong> (<em>number</em>) – Fixed threshold, is made positive.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>pval</strong> – Returns 0 if numpy.abs(value) is smaller than fixed_thres and 1
else.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">bool</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tigramite.independence_tests.CondIndTest.get_measure">
<code class="descname">get_measure</code><span class="sig-paren">(</span><em>X</em>, <em>Y</em>, <em>Z=None</em>, <em>tau_max=0</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.independence_tests.CondIndTest.get_measure" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate dependence measure.</p>
<p>Calls the dependence measure function. The child classes must specify
a function get_dependence_measure.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Y</strong><strong> [</strong><strong>, </strong><strong>Z</strong><strong>]</strong> (<em>X</em><em>,</em>) – X,Y,Z are of the form [(var, -tau)], where var specifies the
variable index and tau the time lag.</li>
<li><strong>tau_max</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 0</em><em>)</em>) – Maximum time lag. This may be used to make sure that estimates for
different lags in X, Z, all have the same sample size.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>val</strong> – The test statistic value.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tigramite.independence_tests.CondIndTest.get_model_selection_criterion">
<code class="descname">get_model_selection_criterion</code><span class="sig-paren">(</span><em>j</em>, <em>parents</em>, <em>tau_max=0</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.independence_tests.CondIndTest.get_model_selection_criterion" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class assumption that this is not implemented.  Concrete classes
should override when possible.</p>
</dd></dl>

<dl class="method">
<dt id="tigramite.independence_tests.CondIndTest.get_shuffle_significance">
<code class="descname">get_shuffle_significance</code><span class="sig-paren">(</span><em>array</em>, <em>xyz</em>, <em>value</em>, <em>return_null_dist=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.independence_tests.CondIndTest.get_shuffle_significance" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class assumption that this is not implemented.  Concrete classes
should override when possible.</p>
</dd></dl>

<dl class="method">
<dt id="tigramite.independence_tests.CondIndTest.get_significance">
<code class="descname">get_significance</code><span class="sig-paren">(</span><em>val</em>, <em>array</em>, <em>xyz</em>, <em>T</em>, <em>dim</em>, <em>sig_override=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.independence_tests.CondIndTest.get_significance" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the p-value from whichever significance function is specified
for this test.  If an override is used, then it will call a different
function then specified by self.significance</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>val</strong> (<em>float</em>) – Test statistic value.</li>
<li><strong>array</strong> (<em>array-like</em>) – data array with X, Y, Z in rows and observations in columns</li>
<li><strong>xyz</strong> (<em>array of ints</em>) – XYZ identifier array of shape (dim,).</li>
<li><strong>T</strong> (<em>int</em>) – Sample length</li>
<li><strong>dim</strong> (<em>int</em>) – Dimensionality, ie, number of features.</li>
<li><strong>sig_override</strong> (<em>string</em>) – Must be in ‘analytic’, ‘shuffle_test’, ‘fixed_thres’</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>pval</strong> – P-value.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float or numpy.nan</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="tigramite.independence_tests.CondIndTest.measure">
<code class="descname">measure</code><a class="headerlink" href="#tigramite.independence_tests.CondIndTest.measure" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract property to store the type of independence test.</p>
</dd></dl>

<dl class="method">
<dt id="tigramite.independence_tests.CondIndTest.print_info">
<code class="descname">print_info</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.independence_tests.CondIndTest.print_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Print information about the conditional independence test parameters</p>
</dd></dl>

<dl class="method">
<dt id="tigramite.independence_tests.CondIndTest.run_test">
<code class="descname">run_test</code><span class="sig-paren">(</span><em>X</em>, <em>Y</em>, <em>Z=None</em>, <em>tau_max=0</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.independence_tests.CondIndTest.run_test" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform conditional independence test.</p>
<p>Calls the dependence measure and signficicance test functions. The child
classes must specify a function get_dependence_measure and either or
both functions get_analytic_significance and  get_shuffle_significance.
If recycle_residuals is True, also _get_single_residuals must be
available.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Y</strong><strong>, </strong><strong>Z</strong> (<em>X</em><em>,</em>) – X,Y,Z are of the form [(var, -tau)], where var specifies the
variable index and tau the time lag.</li>
<li><strong>tau_max</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 0</em><em>)</em>) – Maximum time lag. This may be used to make sure that estimates for
different lags in X, Z, all have the same sample size.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>val, pval</strong> – The test statistic value and the p-value.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Tuple of floats</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tigramite.independence_tests.CondIndTest.set_dataframe">
<code class="descname">set_dataframe</code><span class="sig-paren">(</span><em>dataframe</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.independence_tests.CondIndTest.set_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize and check the dataframe.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>dataframe</strong> (<em>data object</em>) – Set tigramite dataframe object. It must have the attributes
dataframe.values yielding a numpy array of shape (observations T,
variables N) and optionally a mask of the same shape and a missing
values flag.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tigramite.independence_tests.CondIndTest.set_mask_type">
<code class="descname">set_mask_type</code><span class="sig-paren">(</span><em>mask_type</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.independence_tests.CondIndTest.set_mask_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Setter for mask type to ensure that this option does not clash with
recycle_residuals.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>mask_type</strong> (<em>str</em>) – Must be in {‘y’,’x’,’z’,’xy’,’xz’,’yz’,’xyz’}
Masking mode: Indicators for which variables in the dependence
measure I(X; Y | Z) the samples should be masked. If None, ‘y’ is
used, which excludes all time slices containing masked samples in Y.
Explained in <a class="footnote-reference" href="#id5" id="id11">[1]</a>.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<p>Test statistics:</p>
<dl class="class">
<dt id="tigramite.independence_tests.ParCorr">
<em class="property">class </em><code class="descclassname">tigramite.independence_tests.</code><code class="descname">ParCorr</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.independence_tests.ParCorr" title="Permalink to this definition">¶</a></dt>
<dd><p>Partial correlation test.</p>
<p>Partial correlation is estimated through linear ordinary least squares (OLS)
regression and a test for non-zero linear Pearson correlation on the
residuals.</p>
<p class="rubric">Notes</p>
<p>To test <img class="math" src="_images/math/d843100cd0a02e1e5184694228a7ac41e19e8af2.png" alt="X \perp Y | Z"/>, first <img class="math" src="_images/math/bcb2457ac9d8995a4f34d57cadac7ecbbe58f3bd.png" alt="Z"/> is regressed out from
<img class="math" src="_images/math/7a7bb470119808e2db2879fc2b2526f467b7a40b.png" alt="X"/> and <img class="math" src="_images/math/0062c26909b3e07ee8f5a6285b2563d69bc979ff.png" alt="Y"/> assuming the  model</p>
<div class="math">
<p><img src="_images/math/3d927294dd9fee97ab16ad5032baf0c08cdda4c2.png" alt="X &amp; =  Z \beta_X + \epsilon_{X} \\
Y &amp; =  Z \beta_Y + \epsilon_{Y}"/></p>
</div><p>using OLS regression. Then the dependency of the residuals is tested with
the Pearson correlation test.</p>
<div class="math">
<p><img src="_images/math/9c7f8f771e36601a75e3520845155d09080f6281.png" alt="\rho\left(r_X, r_Y\right)"/></p>
</div><p>For the <code class="docutils literal notranslate"><span class="pre">significance='analytic'</span></code> Student’s-<em>t</em> distribution with
<img class="math" src="_images/math/e03ea88dda29ab6daa19c839ff37b8115e0a10e1.png" alt="T-D_Z-2"/> degrees of freedom is implemented.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>**kwargs</strong> – Arguments passed on to Parent class CondIndTest.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tigramite.independence_tests.ParCorr.get_analytic_confidence">
<code class="descname">get_analytic_confidence</code><span class="sig-paren">(</span><em>value</em>, <em>df</em>, <em>conf_lev</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.independence_tests.ParCorr.get_analytic_confidence" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns analytic confidence interval for correlation coefficient.</p>
<p>Based on Student’s t-distribution.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>value</strong> (<em>float</em>) – Test statistic value.</li>
<li><strong>df</strong> (<em>int</em>) – degrees of freedom of the test</li>
<li><strong>conf_lev</strong> (<em>float</em>) – Confidence interval, eg, 0.9</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>(conf_lower, conf_upper)</strong> – Upper and lower confidence bound of confidence interval.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Tuple of floats</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tigramite.independence_tests.ParCorr.get_analytic_significance">
<code class="descname">get_analytic_significance</code><span class="sig-paren">(</span><em>value</em>, <em>T</em>, <em>dim</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.independence_tests.ParCorr.get_analytic_significance" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns analytic p-value from Student’s t-test for the Pearson
correlation coefficient.</p>
<p>Assumes two-sided correlation. If the degrees of freedom are less than
1, numpy.nan is returned.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>value</strong> (<em>float</em>) – Test statistic value.</li>
<li><strong>T</strong> (<em>int</em>) – Sample length</li>
<li><strong>dim</strong> (<em>int</em>) – Dimensionality, ie, number of features.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>pval</strong> – P-value.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float or numpy.nan</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tigramite.independence_tests.ParCorr.get_dependence_measure">
<code class="descname">get_dependence_measure</code><span class="sig-paren">(</span><em>array</em>, <em>xyz</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.independence_tests.ParCorr.get_dependence_measure" title="Permalink to this definition">¶</a></dt>
<dd><p>Return partial correlation.</p>
<p>Estimated as the Pearson correlation of the residuals of a linear
OLS regression.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>array</strong> (<em>array-like</em>) – data array with X, Y, Z in rows and observations in columns</li>
<li><strong>xyz</strong> (<em>array of ints</em>) – XYZ identifier array of shape (dim,).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>val</strong> – Partial correlation coefficient.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tigramite.independence_tests.ParCorr.get_model_selection_criterion">
<code class="descname">get_model_selection_criterion</code><span class="sig-paren">(</span><em>j</em>, <em>parents</em>, <em>tau_max=0</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.independence_tests.ParCorr.get_model_selection_criterion" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns Akaike’s Information criterion modulo constants.</p>
<p>Fits a linear model of the parents to variable j and returns the score.
I used to determine optimal hyperparameters in PCMCI, in particular
the pc_alpha value.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>j</strong> (<em>int</em>) – Index of target variable in data array.</li>
<li><strong>parents</strong> (<em>list</em>) – List of form [(0, -1), (3, -2), …] containing parents.</li>
<li><strong>tau_max</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 0</em><em>)</em>) – Maximum time lag. This may be used to make sure that estimates for
different lags in X, Z, all have the same sample size.</li>
<li><strong>Returns</strong> – </li>
<li><strong>score</strong> (<em>float</em>) – Model score.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tigramite.independence_tests.ParCorr.get_shuffle_significance">
<code class="descname">get_shuffle_significance</code><span class="sig-paren">(</span><em>array</em>, <em>xyz</em>, <em>value</em>, <em>return_null_dist=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.independence_tests.ParCorr.get_shuffle_significance" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns p-value for shuffle significance test.</p>
<p>For residual-based test statistics only the residuals are shuffled.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>array</strong> (<em>array-like</em>) – data array with X, Y, Z in rows and observations in columns</li>
<li><strong>xyz</strong> (<em>array of ints</em>) – XYZ identifier array of shape (dim,).</li>
<li><strong>value</strong> (<em>number</em>) – Value of test statistic for unshuffled estimate.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>pval</strong> – p-value</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="tigramite.independence_tests.ParCorr.measure">
<code class="descname">measure</code><a class="headerlink" href="#tigramite.independence_tests.ParCorr.measure" title="Permalink to this definition">¶</a></dt>
<dd><p>Concrete property to return the measure of the independence test</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tigramite.independence_tests.GPDC">
<em class="property">class </em><code class="descclassname">tigramite.independence_tests.</code><code class="descname">GPDC</code><span class="sig-paren">(</span><em>null_dist_filename=None</em>, <em>gp_version='new'</em>, <em>gp_params=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.independence_tests.GPDC" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>GPDC conditional independence test based on Gaussian processes and</dt>
<dd>distance correlation.</dd>
</dl>
<p>GPDC is based on a Gaussian process (GP) regression and a distance
correlation test on the residuals <a class="footnote-reference" href="#id14" id="id12">[2]</a>. GP is estimated with scikit-learn
and allows to flexibly specify kernels and hyperparameters or let them be
optimized automatically. The distance correlation test is implemented with
cython. Here the null distribution is not analytically available, but can be
precomputed with the function generate_and_save_nulldists(…) which saves a
*.npz file containing the null distribution for different sample sizes.
This file can then be supplied as null_dist_filename.</p>
<p class="rubric">Notes</p>
<p>GPDC is based on a Gaussian process (GP) regression and a distance
correlation test on the residuals. Distance correlation is described in
<a class="footnote-reference" href="#id14" id="id13">[2]</a>. To test <img class="math" src="_images/math/d843100cd0a02e1e5184694228a7ac41e19e8af2.png" alt="X \perp Y | Z"/>, first <img class="math" src="_images/math/bcb2457ac9d8995a4f34d57cadac7ecbbe58f3bd.png" alt="Z"/> is regressed out from
<img class="math" src="_images/math/7a7bb470119808e2db2879fc2b2526f467b7a40b.png" alt="X"/> and <img class="math" src="_images/math/0062c26909b3e07ee8f5a6285b2563d69bc979ff.png" alt="Y"/> assuming the  model</p>
<div class="math">
<p><img src="_images/math/70852cea72eb5c4d0a45c0db08b49476f4404426.png" alt="X &amp; =  f_X(Z) + \epsilon_{X} \\
Y &amp; =  f_Y(Z) + \epsilon_{Y}  \\
\epsilon_{X,Y} &amp;\sim \mathcal{N}(0, \sigma^2)"/></p>
</div><p>using GP regression. Here <img class="math" src="_images/math/7a3d0c9264473a58cc3a769f99a662631131377c.png" alt="\sigma^2"/> and the kernel bandwidth are
optimzed using <code class="docutils literal notranslate"><span class="pre">sklearn</span></code>. Then the residuals  are transformed to uniform
marginals yielding <img class="math" src="_images/math/21fc11b715eef698662fe1cc017d7ae2d53320d8.png" alt="r_X,r_Y"/> and their dependency is tested with</p>
<div class="math">
<p><img src="_images/math/7bce831f5eba0d0e0fcb0cced170b2926804500a.png" alt="\mathcal{R}\left(r_X, r_Y\right)"/></p>
</div><p>The null distribution of the distance correlation should be pre-computed.
Otherwise it is computed during runtime.</p>
<p>The cython-code for distance correlation is Copyright (c) 2012, Florian
Finkernagel (<a class="reference external" href="https://gist.github.com/ffinkernagel/2960386">https://gist.github.com/ffinkernagel/2960386</a>).</p>
<p class="rubric">References</p>
<table class="docutils footnote" frame="void" id="id14" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[2]</td><td><em>(<a class="fn-backref" href="#id12">1</a>, <a class="fn-backref" href="#id13">2</a>)</em> Gabor J. Szekely, Maria L. Rizzo, and Nail K. Bakirov: Measuring and
testing dependence by correlation of distances,
<a class="reference external" href="https://arxiv.org/abs/0803.4101">https://arxiv.org/abs/0803.4101</a></td></tr>
</tbody>
</table>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>null_dist_filename</strong> (<em>str</em><em>, </em><em>otional</em><em> (</em><em>default: None</em><em>)</em>) – Path to file containing null distribution.</li>
<li><strong>gp_version</strong> (<em>{'new'</em><em>, </em><em>'old'}</em><em>, </em><em>optional</em><em> (</em><em>default: 'new'</em><em>)</em>) – The older GP version from scikit-learn 0.17 was used for the numerical
simulations in <a class="footnote-reference" href="#id5" id="id15">[1]</a>. The newer version from scikit-learn 0.19 is faster
and allows more flexibility regarding kernels etc.</li>
<li><strong>gp_params</strong> (<em>dictionary</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Dictionary with parameters for <code class="docutils literal notranslate"><span class="pre">GaussianProcessRegressor</span></code>.</li>
<li><strong>**kwargs</strong> – Arguments passed on to parent class GaussProcReg.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tigramite.independence_tests.GPDC.generate_and_save_nulldists">
<code class="descname">generate_and_save_nulldists</code><span class="sig-paren">(</span><em>sample_sizes</em>, <em>null_dist_filename</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.independence_tests.GPDC.generate_and_save_nulldists" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates and saves null distribution for pairwise independence
tests.</p>
<p>Generates the null distribution for different sample sizes. Calls
generate_nulldist. Null dists are saved to disk as
self.null_dist_filename.npz. Also adds the null distributions to
self.gauss_pr.null_dists.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sample_sizes</strong> (<em>list</em>) – List of sample sizes.</li>
<li><strong>null_dist_filename</strong> (<em>str</em>) – Name to save file containing null distributions.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tigramite.independence_tests.GPDC.generate_nulldist">
<code class="descname">generate_nulldist</code><span class="sig-paren">(</span><em>df</em>, <em>add_to_null_dists=True</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.independence_tests.GPDC.generate_nulldist" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates null distribution for pairwise independence tests.</p>
<p>Generates the null distribution for sample size df. Assumes pairwise
samples transformed to uniform marginals. Uses get_dependence_measure
available in class and generates self.sig_samples random samples. Adds
the null distributions to self.gauss_pr.null_dists.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>df</strong> (<em>int</em>) – Degrees of freedom / sample size to generate null distribution for.</li>
<li><strong>add_to_null_dists</strong> (<em>bool</em><em>, </em><em>optional</em><em> (</em><em>default: True</em><em>)</em>) – Whether to add the null dist to the dictionary of null dists or
just return it.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>null_dist</strong> – Only returned,if add_to_null_dists is False.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array of shape [df,]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tigramite.independence_tests.GPDC.get_analytic_significance">
<code class="descname">get_analytic_significance</code><span class="sig-paren">(</span><em>value</em>, <em>T</em>, <em>dim</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.independence_tests.GPDC.get_analytic_significance" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns p-value for the distance correlation coefficient.</p>
<p>The null distribution for necessary degrees of freedom (df) is loaded.
If not available, the null distribution is generated with the function
generate_nulldist(). It is recommended to generate the nulldists for a
wide range of sample sizes beforehand with the function
generate_and_save_nulldists(…). The distance correlation coefficient
is one-sided. If the degrees of freedom are less than 1, numpy.nan is
returned.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>value</strong> (<em>float</em>) – Test statistic value.</li>
<li><strong>T</strong> (<em>int</em>) – Sample length</li>
<li><strong>dim</strong> (<em>int</em>) – Dimensionality, ie, number of features.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>pval</strong> – P-value.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float or numpy.nan</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tigramite.independence_tests.GPDC.get_dependence_measure">
<code class="descname">get_dependence_measure</code><span class="sig-paren">(</span><em>array</em>, <em>xyz</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.independence_tests.GPDC.get_dependence_measure" title="Permalink to this definition">¶</a></dt>
<dd><p>Return GPDC measure.</p>
<p>Estimated as the distance correlation of the residuals of a GP
regression.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>array</strong> (<em>array-like</em>) – data array with X, Y, Z in rows and observations in columns</li>
<li><strong>xyz</strong> (<em>array of ints</em>) – XYZ identifier array of shape (dim,).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>val</strong> – GPDC test statistic.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tigramite.independence_tests.GPDC.get_model_selection_criterion">
<code class="descname">get_model_selection_criterion</code><span class="sig-paren">(</span><em>j</em>, <em>parents</em>, <em>tau_max=0</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.independence_tests.GPDC.get_model_selection_criterion" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns log marginal likelihood for GP regression.</p>
<p>Fits a GP model of the parents to variable j and returns the negative
log marginal likelihood as a model selection score. Is used to determine
optimal hyperparameters in PCMCI, in particular the pc_alpha value.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>j</strong> (<em>int</em>) – Index of target variable in data array.</li>
<li><strong>parents</strong> (<em>list</em>) – List of form [(0, -1), (3, -2), …] containing parents.</li>
<li><strong>tau_max</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 0</em><em>)</em>) – Maximum time lag. This may be used to make sure that estimates for
different lags in X, Z, all have the same sample size.</li>
<li><strong>Returns</strong> – </li>
<li><strong>score</strong> (<em>float</em>) – Model score.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tigramite.independence_tests.GPDC.get_shuffle_significance">
<code class="descname">get_shuffle_significance</code><span class="sig-paren">(</span><em>array</em>, <em>xyz</em>, <em>value</em>, <em>return_null_dist=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.independence_tests.GPDC.get_shuffle_significance" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns p-value for shuffle significance test.</p>
<p>For residual-based test statistics only the residuals are shuffled.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>array</strong> (<em>array-like</em>) – data array with X, Y, Z in rows and observations in columns</li>
<li><strong>xyz</strong> (<em>array of ints</em>) – XYZ identifier array of shape (dim,).</li>
<li><strong>value</strong> (<em>number</em>) – Value of test statistic for unshuffled estimate.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>pval</strong> – p-value</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="tigramite.independence_tests.GPDC.measure">
<code class="descname">measure</code><a class="headerlink" href="#tigramite.independence_tests.GPDC.measure" title="Permalink to this definition">¶</a></dt>
<dd><p>Concrete property to return the measure of the independence test</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tigramite.independence_tests.CMIknn">
<em class="property">class </em><code class="descclassname">tigramite.independence_tests.</code><code class="descname">CMIknn</code><span class="sig-paren">(</span><em>knn=0.2</em>, <em>shuffle_neighbors=5</em>, <em>significance='shuffle_test'</em>, <em>transform='standardize'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.independence_tests.CMIknn" title="Permalink to this definition">¶</a></dt>
<dd><p>Conditional mutual information test based on nearest-neighbor estimator.</p>
<p>Conditional mutual information is the most general dependency measure coming
from an information-theoretic framework. It makes no assumptions about the
parametric form of the dependencies by directly estimating the underlying
joint density. The test here is based on the estimator in  S. Frenzel and B.
Pompe, Phys. Rev. Lett. 99, 204101 (2007), combined with a shuffle test to
generate  the distribution under the null hypothesis of independence first
used in <a class="footnote-reference" href="#id17" id="id16">[3]</a>. The knn-estimator is suitable only for variables taking a
continuous range of values. For discrete variables use the CMIsymb class.</p>
<p class="rubric">Notes</p>
<p>CMI is given by</p>
<div class="math">
<p><img src="_images/math/d6d56a5dd20011b190ba97d6f36d154e11c9035c.png" alt="I(X;Y|Z) &amp;= \int p(z)  \iint  p(x,y|z) \log
\frac{ p(x,y |z)}{p(x|z)\cdot p(y |z)} \,dx dy dz"/></p>
</div><p>Its knn-estimator is given by</p>
<div class="math">
<p><img src="_images/math/14f247b2a9ccd480e67621eb0d8a2d7a68a285bd.png" alt="\widehat{I}(X;Y|Z)  &amp;=   \psi (k) + \frac{1}{T} \sum_{t=1}^T
\left[ \psi(k_{Z,t}) - \psi(k_{XZ,t}) - \psi(k_{YZ,t}) \right]"/></p>
</div><p>where <img class="math" src="_images/math/499a2ee48b33448e80b97af9df9550828bdbfb59.png" alt="\psi"/> is the Digamma function.  This estimator has as a
parameter the number of nearest-neighbors <img class="math" src="_images/math/0b7c1e16a3a8a849bb8ffdcdbf86f65fd1f30438.png" alt="k"/> which determines the
size of hyper-cubes around each (high-dimensional) sample point. Then
<img class="math" src="_images/math/a23635874ee5c9865debbf9c8686e9367f2850e5.png" alt="k_{Z,},k_{XZ},k_{YZ}"/> are the numbers of neighbors in the respective
subspaces.</p>
<p><img class="math" src="_images/math/0b7c1e16a3a8a849bb8ffdcdbf86f65fd1f30438.png" alt="k"/> can be viewed as a density smoothing parameter (although it is
data-adaptive unlike fixed-bandwidth estimators). For large <img class="math" src="_images/math/0b7c1e16a3a8a849bb8ffdcdbf86f65fd1f30438.png" alt="k"/>, the
underlying dependencies are more smoothed and CMI has a larger bias,
but lower variance, which is more important for significance testing. Note
that the estimated CMI values can be slightly negative while CMI is a non-
negative quantity.</p>
<p>This method requires the scipy.spatial.cKDTree package and the tigramite
cython module.</p>
<p class="rubric">References</p>
<table class="docutils footnote" frame="void" id="id17" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id16">[3]</a></td><td>J. Runge (2018): Conditional Independence Testing Based on a
Nearest-Neighbor Estimator of Conditional Mutual Information.
In Proceedings of the 21st International Conference on Artificial
Intelligence and Statistics.
<a class="reference external" href="http://proceedings.mlr.press/v84/runge18a.html">http://proceedings.mlr.press/v84/runge18a.html</a></td></tr>
</tbody>
</table>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>knn</strong> (<em>int</em><em> or </em><em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 0.2</em><em>)</em>) – Number of nearest-neighbors which determines the size of hyper-cubes
around each (high-dimensional) sample point. If smaller than 1, this is
computed as a fraction of T, hence knn=knn*T. For knn larger or equal to
1, this is the absolute number.</li>
<li><strong>shuffle_neighbors</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 10</em><em>)</em>) – Number of nearest-neighbors within Z for the shuffle surrogates which
determines the size of hyper-cubes around each (high-dimensional) sample
point.</li>
<li><strong>transform</strong> (<em>{'standardize'</em><em>, </em><em>'ranks'</em><em>,  </em><em>'uniform'</em><em>, </em><em>False}</em><em>, </em><em>optional</em>) – (default: ‘standardize’)
Whether to transform the array beforehand by standardizing
or transforming to uniform marginals.</li>
<li><strong>significance</strong> (<em>str</em><em>, </em><em>optional</em><em> (</em><em>default: 'shuffle_test'</em><em>)</em>) – Type of significance test to use. For CMIknn only ‘fixed_thres’ and
‘shuffle_test’ are available.</li>
<li><strong>**kwargs</strong> – Arguments passed on to parent class CondIndTest.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tigramite.independence_tests.CMIknn.get_dependence_measure">
<code class="descname">get_dependence_measure</code><span class="sig-paren">(</span><em>array</em>, <em>xyz</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.independence_tests.CMIknn.get_dependence_measure" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns CMI estimate as described in Frenzel and Pompe PRL (2007).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>array</strong> (<em>array-like</em>) – data array with X, Y, Z in rows and observations in columns</li>
<li><strong>xyz</strong> (<em>array of ints</em>) – XYZ identifier array of shape (dim,).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>val</strong> – Conditional mutual information estimate.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tigramite.independence_tests.CMIknn.get_shuffle_significance">
<code class="descname">get_shuffle_significance</code><span class="sig-paren">(</span><em>array</em>, <em>xyz</em>, <em>value</em>, <em>return_null_dist=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.independence_tests.CMIknn.get_shuffle_significance" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns p-value for nearest-neighbor shuffle significance test.</p>
<p>For non-empty Z, overwrites get_shuffle_significance from the parent
class  which is a block shuffle test, which does not preserve
dependencies of X and Y with Z. Here the parameter shuffle_neighbors is
used to permute only those values <img class="math" src="_images/math/7720e563212e11bf72de255ab82c2a3b97c1a7f5.png" alt="x_i"/> and <img class="math" src="_images/math/bdb2d04d69b82c2288f5ef46664d548355e130af.png" alt="x_j"/> for which
<img class="math" src="_images/math/ab1718d730cd7b17532f760861e9659b68a65156.png" alt="z_j"/> is among the nearest niehgbors of <img class="math" src="_images/math/6de62736d8aa90101801d7a1416e97e921d1620f.png" alt="z_i"/>. If Z is
empty, the block-shuffle test is used.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>array</strong> (<em>array-like</em>) – data array with X, Y, Z in rows and observations in columns</li>
<li><strong>xyz</strong> (<em>array of ints</em>) – XYZ identifier array of shape (dim,).</li>
<li><strong>value</strong> (<em>number</em>) – Value of test statistic for unshuffled estimate.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>pval</strong> – p-value</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="tigramite.independence_tests.CMIknn.measure">
<code class="descname">measure</code><a class="headerlink" href="#tigramite.independence_tests.CMIknn.measure" title="Permalink to this definition">¶</a></dt>
<dd><p>Concrete property to return the measure of the independence test</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tigramite.independence_tests.CMIsymb">
<em class="property">class </em><code class="descclassname">tigramite.independence_tests.</code><code class="descname">CMIsymb</code><span class="sig-paren">(</span><em>n_symbs=None</em>, <em>significance='shuffle_test'</em>, <em>sig_blocklength=1</em>, <em>conf_blocklength=1</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.independence_tests.CMIsymb" title="Permalink to this definition">¶</a></dt>
<dd><p>Conditional mutual information test based on discrete estimator.</p>
<p>Conditional mutual information is the most general dependency measure
coming from an information-theoretic framework. It makes no assumptions
about the parametric form of the dependencies by directly estimating the
underlying joint density. The test here is based on directly estimating
the joint distribution assuming symbolic input, combined with a
shuffle test to generate  the distribution under the null hypothesis of
independence. The knn-estimator is suitable only for discrete variables.
For continuous variables, either pre-process the data using the functions
in data_processing or, better, use the CMIknn class.</p>
<p class="rubric">Notes</p>
<p>CMI and its estimator are given by</p>
<div class="math">
<p><img src="_images/math/503d970dfd19d2f6bfd5f3d3876a74d8816cbf70.png" alt="I(X;Y|Z) &amp;= \sum p(z)  \sum \sum  p(x,y|z) \log
\frac{ p(x,y |z)}{p(x|z)\cdot p(y |z)} \,dx dy dz"/></p>
</div><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>n_symbs</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Number of symbols in input data. If None, n_symbs=data.max()+1</li>
<li><strong>significance</strong> (<em>str</em><em>, </em><em>optional</em><em> (</em><em>default: 'shuffle_test'</em><em>)</em>) – Type of significance test to use. For CMIsymb only ‘fixed_thres’ and
‘shuffle_test’ are available.</li>
<li><strong>sig_blocklength</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 1</em><em>)</em>) – Block length for block-shuffle significance test.</li>
<li><strong>conf_blocklength</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 1</em><em>)</em>) – Block length for block-bootstrap.</li>
<li><strong>**kwargs</strong> – Arguments passed on to parent class CondIndTest.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tigramite.independence_tests.CMIsymb.get_dependence_measure">
<code class="descname">get_dependence_measure</code><span class="sig-paren">(</span><em>array</em>, <em>xyz</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.independence_tests.CMIsymb.get_dependence_measure" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns CMI estimate based on bincount histogram.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>array</strong> (<em>array-like</em>) – data array with X, Y, Z in rows and observations in columns</li>
<li><strong>xyz</strong> (<em>array of ints</em>) – XYZ identifier array of shape (dim,).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>val</strong> – Conditional mutual information estimate.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tigramite.independence_tests.CMIsymb.get_shuffle_significance">
<code class="descname">get_shuffle_significance</code><span class="sig-paren">(</span><em>array</em>, <em>xyz</em>, <em>value</em>, <em>return_null_dist=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.independence_tests.CMIsymb.get_shuffle_significance" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns p-value for shuffle significance test.</p>
<p>For residual-based test statistics only the residuals are shuffled.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>array</strong> (<em>array-like</em>) – data array with X, Y, Z in rows and observations in columns</li>
<li><strong>xyz</strong> (<em>array of ints</em>) – XYZ identifier array of shape (dim,).</li>
<li><strong>value</strong> (<em>number</em>) – Value of test statistic for unshuffled estimate.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>pval</strong> – p-value</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="tigramite.independence_tests.CMIsymb.measure">
<code class="descname">measure</code><a class="headerlink" href="#tigramite.independence_tests.CMIsymb.measure" title="Permalink to this definition">¶</a></dt>
<dd><p>Concrete property to return the measure of the independence test</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tigramite.independence_tests.RCOT">
<em class="property">class </em><code class="descclassname">tigramite.independence_tests.</code><code class="descname">RCOT</code><span class="sig-paren">(</span><em>num_f=25</em>, <em>approx='lpd4'</em>, <em>seed=42</em>, <em>significance='analytic'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.independence_tests.RCOT" title="Permalink to this definition">¶</a></dt>
<dd><p>Randomized Conditional Correlation Test.</p>
<p>Tests conditional independence in the fully non-parametric setting based on
Kernel measures. For not too small sample sizes, the test can utilize an
analytic approximation of the null distribution making it very fast. Based
on r-package <code class="docutils literal notranslate"><span class="pre">rcit</span></code>. This test is described in <a class="footnote-reference" href="#id20" id="id18">[5]</a>.</p>
<p class="rubric">Notes</p>
<p>RCOT is a fast variant of the Kernel Conditional Independence Test (KCIT)
utilizing random Fourier features. Kernel tests measure conditional
independence in the fully non-parametric setting. In practice, RCOT tests
scale linearly with sample size and return accurate p-values much faster
than KCIT in the large sample size context. To use the analytical null
approximation, the sample size should be at least ~1000.</p>
<p>The method is fully described in <a class="footnote-reference" href="#id20" id="id19">[5]</a> and the r-package documentation. The
free parameters are the approximation of the partial kernel cross-covariance
matrix and the number of random fourier features for the conditioning set.
One caveat is that RCOT is, as the name suggests, based on random fourier
features. To get reproducable results, you should fix the seed (default).</p>
<p>This class requires the rpy package and the prior installation of <code class="docutils literal notranslate"><span class="pre">rcit</span></code>
from <a class="reference external" href="https://github.com/ericstrobl/RCIT">https://github.com/ericstrobl/RCIT</a>.</p>
<p class="rubric">References</p>
<table class="docutils footnote" frame="void" id="id20" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[5]</td><td><em>(<a class="fn-backref" href="#id18">1</a>, <a class="fn-backref" href="#id19">2</a>)</em> Eric V. Strobl, Kun Zhang, Shyam Visweswaran:
Approximate Kernel-based Conditional Independence Tests for Fast Non-
Parametric Causal Discovery.
<a class="reference external" href="https://arxiv.org/abs/1702.03877">https://arxiv.org/abs/1702.03877</a></td></tr>
</tbody>
</table>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>num_f</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of random fourier features for conditioning set. More features
better approximate highly structured joint densities, but take more
computational time.</li>
<li><strong>approx</strong> (<em>str</em><em>, </em><em>optional</em>) – Which approximation of the partial cross-covariance matrix, options:
‘lpd4’ the Lindsay-Pilla-Basak method (default), ‘gamma’ for the
Satterthwaite-Welch method, ‘hbe’ for the Hall-Buckley-Eagleson method,
‘chi2’ for a normalized chi-squared statistic, ‘perm’ for permutation
testing (warning: this one is slow).</li>
<li><strong>seed</strong> (<em>int</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Which random fourier feature seed to use. If None, you won’t get
reproducable results.</li>
<li><strong>significance</strong> (<em>str</em><em>, </em><em>optional</em><em> (</em><em>default: 'analytic'</em><em>)</em>) – Type of significance test to use.</li>
<li><strong>**kwargs</strong> – Arguments passed on to parent class CondIndTest.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tigramite.independence_tests.RCOT.get_analytic_significance">
<code class="descname">get_analytic_significance</code><span class="sig-paren">(</span><em>**args</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.independence_tests.RCOT.get_analytic_significance" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns analytic p-value from RCoT test statistic.
NOTE: Must first run get_dependence_measure, where p-value is determined
from RCoT test statistic.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>pval</strong> – P-value.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">float or numpy.nan</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tigramite.independence_tests.RCOT.get_dependence_measure">
<code class="descname">get_dependence_measure</code><span class="sig-paren">(</span><em>array</em>, <em>xyz</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.independence_tests.RCOT.get_dependence_measure" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns RCOT estimate.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>array</strong> (<em>array-like</em>) – data array with X, Y, Z in rows and observations in columns</li>
<li><strong>xyz</strong> (<em>array of ints</em>) – XYZ identifier array of shape (dim,).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>val</strong> – RCOT estimate.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tigramite.independence_tests.RCOT.get_shuffle_significance">
<code class="descname">get_shuffle_significance</code><span class="sig-paren">(</span><em>array</em>, <em>xyz</em>, <em>value</em>, <em>return_null_dist=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.independence_tests.RCOT.get_shuffle_significance" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns p-value for shuffle significance test.</p>
<p>For residual-based test statistics only the residuals are shuffled.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>array</strong> (<em>array-like</em>) – data array with X, Y, Z in rows and observations in columns</li>
<li><strong>xyz</strong> (<em>array of ints</em>) – XYZ identifier array of shape (dim,).</li>
<li><strong>value</strong> (<em>number</em>) – Value of test statistic for unshuffled estimate.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>pval</strong> – p-value</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="tigramite.independence_tests.RCOT.measure">
<code class="descname">measure</code><a class="headerlink" href="#tigramite.independence_tests.RCOT.measure" title="Permalink to this definition">¶</a></dt>
<dd><p>Concrete property to return the measure of the independence test</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-tigramite.data_processing">
<span id="tigramite-data-processing-data-processing-functions"></span><h1><a class="reference internal" href="#module-tigramite.data_processing" title="tigramite.data_processing"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tigramite.data_processing</span></code></a>: Data processing functions<a class="headerlink" href="#module-tigramite.data_processing" title="Permalink to this headline">¶</a></h1>
<p>Tigramite data processing functions.</p>
<dl class="class">
<dt id="tigramite.data_processing.DataFrame">
<em class="property">class </em><code class="descclassname">tigramite.data_processing.</code><code class="descname">DataFrame</code><span class="sig-paren">(</span><em>data</em>, <em>mask=None</em>, <em>missing_flag=None</em>, <em>var_names=None</em>, <em>datatime=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.data_processing.DataFrame" title="Permalink to this definition">¶</a></dt>
<dd><p>Data object containing time series array and optional mask.</p>
<p>Alternatively, a panda dataframe can be used.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>data</strong> (<em>array-like</em>) – Numpy array of shape (observations T, variables N)</li>
<li><strong>mask</strong> (<em>array-like</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Optional mask array, must be of same shape as data</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="tigramite.data_processing.DataFrame.data">
<code class="descname">data</code><a class="headerlink" href="#tigramite.data_processing.DataFrame.data" title="Permalink to this definition">¶</a></dt>
<dd><p><em>array-like</em> – Numpy array of shape (observations T, variables N)</p>
</dd></dl>

<dl class="attribute">
<dt id="tigramite.data_processing.DataFrame.mask">
<code class="descname">mask</code><a class="headerlink" href="#tigramite.data_processing.DataFrame.mask" title="Permalink to this definition">¶</a></dt>
<dd><p><em>array-like, optional (default: None)</em> – Optional mask array, must be of same shape as data</p>
</dd></dl>

<dl class="attribute">
<dt id="tigramite.data_processing.DataFrame.missing_flag">
<code class="descname">missing_flag</code><a class="headerlink" href="#tigramite.data_processing.DataFrame.missing_flag" title="Permalink to this definition">¶</a></dt>
<dd><p><em>number, optional (default: None)</em> – Flag for missing values in dataframe. Dismisses all time slices of
samples where missing values occur in any variable and also flags
samples for all lags up to 2*tau_max. This avoids biases, see
section on masking in Supplement of <a class="footnote-reference" href="#id5" id="id21">[1]</a>.</p>
</dd></dl>

<dl class="attribute">
<dt id="tigramite.data_processing.DataFrame.var_names">
<code class="descname">var_names</code><a class="headerlink" href="#tigramite.data_processing.DataFrame.var_names" title="Permalink to this definition">¶</a></dt>
<dd><p><em>list of strings, optional (default: range(N))</em> – Names of variables, must match the number of variables. If None is
passed, variables are enumerated as [0, 1, …]</p>
</dd></dl>

<dl class="attribute">
<dt id="tigramite.data_processing.DataFrame.datatime">
<code class="descname">datatime</code><a class="headerlink" href="#tigramite.data_processing.DataFrame.datatime" title="Permalink to this definition">¶</a></dt>
<dd><p><em>array-like, optional (default: None)</em> – Timelabel array. If None, range(T) is used.</p>
</dd></dl>

<dl class="method">
<dt id="tigramite.data_processing.DataFrame.construct_array">
<code class="descname">construct_array</code><span class="sig-paren">(</span><em>X</em>, <em>Y</em>, <em>Z</em>, <em>tau_max</em>, <em>mask=None</em>, <em>mask_type=None</em>, <em>return_cleaned_xyz=False</em>, <em>do_checks=True</em>, <em>cut_off='2xtau_max'</em>, <em>verbosity=0</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.data_processing.DataFrame.construct_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs array from variables X, Y, Z from data.</p>
<p>Data is of shape (T, N), where T is the time series length and N the
number of variables.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Y</strong><strong>, </strong><strong>Z</strong> (<em>X</em><em>,</em>) – For a dependence measure I(X;Y|Z), Y is of the form [(varY, 0)],
where var specifies the variable index. X typically is of the form
[(varX, -tau)] with tau denoting the time lag and Z can be
multivariate [(var1, -lag), (var2, -lag), …] .</li>
<li><strong>tau_max</strong> (<em>int</em>) – Maximum time lag. This may be used to make sure that estimates for
different lags in X and Z all have the same sample size.</li>
<li><strong>mask</strong> (<em>array-like</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Optional mask array, must be of same shape as data.  If it is set,
then it overrides the self.mask assigned to the dataframe. If it is
None, then the self.mask is used, if it exists.</li>
<li><strong>mask_type</strong> (<em>{'y'</em><em>,</em><em>'x'</em><em>,</em><em>'z'</em><em>,</em><em>'xy'</em><em>,</em><em>'xz'</em><em>,</em><em>'yz'</em><em>,</em><em>'xyz'}</em>) – Masking mode: Indicators for which variables in the dependence
measure I(X; Y | Z) the samples should be masked. If None, ‘y’ is
used, which excludes all time slices containing masked samples in Y.
Explained in <a class="footnote-reference" href="#id5" id="id22">[1]</a>.</li>
<li><strong>return_cleaned_xyz</strong> (<em>bool</em><em>, </em><em>optional</em><em> (</em><em>default: False</em><em>)</em>) – Whether to return cleaned X,Y,Z, where possible duplicates are
removed.</li>
<li><strong>do_checks</strong> (<em>bool</em><em>, </em><em>optional</em><em> (</em><em>default: True</em><em>)</em>) – Whether to perform sanity checks on input X,Y,Z</li>
<li><strong>cut_off</strong> (<em>{'2xtau_max'</em><em>, </em><em>'max_lag'</em><em>, </em><em>'max_lag_or_tau_max'}</em>) – How many samples to cutoff at the beginning. The default is
‘2xtau_max’, which guarantees that MCI tests are all conducted on
the same samples. For modeling, ‘max_lag_or_tau_max’ can be used,
which uses the maximum of tau_max and the conditions, which is
useful to compare multiple models on the same sample.  Last,
‘max_lag’ uses as much samples as possible.</li>
<li><strong>verbosity</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 0</em><em>)</em>) – Level of verbosity.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><p><strong>array, xyz [,XYZ]</strong> – identifier array of shape (dim,) identifying which row in array
corresponds to X, Y, and Z. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)],</span> <span class="n">Y</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span> <span class="n">Z</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)]</span>
<span class="n">yields</span> <span class="n">an</span> <span class="n">array</span> <span class="n">of</span> <span class="n">shape</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span> <span class="ow">and</span> <span class="n">xyz</span> <span class="ow">is</span>
<span class="n">xyz</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
<p>If return_cleaned_xyz is True, also outputs the cleaned XYZ lists.</p>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Tuple of data array of shape (dim, T) and xyz</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tigramite.data_processing.DataFrame.print_array_info">
<code class="descname">print_array_info</code><span class="sig-paren">(</span><em>array</em>, <em>X</em>, <em>Y</em>, <em>Z</em>, <em>missing_flag</em>, <em>mask_type</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.data_processing.DataFrame.print_array_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Print info about the constructed array</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>array</strong> (<em>Data array of shape</em><em> (</em><em>dim</em><em>, </em><em>T</em><em>)</em>) – </li>
<li><strong>Y</strong><strong>, </strong><strong>Z</strong> (<em>X</em><em>,</em>) – For a dependence measure I(X;Y|Z), Y is of the form [(varY, 0)],
where var specifies the variable index. X typically is of the form
[(varX, -tau)] with tau denoting the time lag and Z can be
multivariate [(var1, -lag), (var2, -lag), …] .</li>
<li><strong>missing_flag</strong> (<em>number</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Flag for missing values. Dismisses all time slices of samples where
missing values occur in any variable and also flags samples for all
lags up to 2*tau_max. This avoids biases, see section on masking in
Supplement of <a class="footnote-reference" href="#id5" id="id23">[1]</a>.</li>
<li><strong>mask_type</strong> (<em>{'y'</em><em>,</em><em>'x'</em><em>,</em><em>'z'</em><em>,</em><em>'xy'</em><em>,</em><em>'xz'</em><em>,</em><em>'yz'</em><em>,</em><em>'xyz'}</em>) – Masking mode: Indicators for which variables in the dependence
measure I(X; Y | Z) the samples should be masked. If None, ‘y’ is
used, which excludes all time slices containing masked samples in Y.
Explained in <a class="footnote-reference" href="#id5" id="id24">[1]</a>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="tigramite.data_processing.lowhighpass_filter">
<code class="descclassname">tigramite.data_processing.</code><code class="descname">lowhighpass_filter</code><span class="sig-paren">(</span><em>data</em>, <em>cutperiod</em>, <em>pass_periods='low'</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.data_processing.lowhighpass_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Butterworth low- or high pass filter.</p>
<p>This function applies a linear filter twice, once forward and once
backwards. The combined filter has linear phase.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<em>array</em>) – Data array of shape (time, variables).</li>
<li><strong>cutperiod</strong> (<em>int</em>) – Period of cutoff.</li>
<li><strong>pass_periods</strong> (<em>str</em><em>, </em><em>optional</em><em> (</em><em>default: 'low'</em><em>)</em>) – Either ‘low’ or ‘high’ to act as a low- or high-pass filter</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>data</strong> – Filtered data array.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tigramite.data_processing.ordinal_patt_array">
<code class="descclassname">tigramite.data_processing.</code><code class="descname">ordinal_patt_array</code><span class="sig-paren">(</span><em>array</em>, <em>array_mask=None</em>, <em>dim=2</em>, <em>step=1</em>, <em>weights=False</em>, <em>verbosity=0</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.data_processing.ordinal_patt_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns symbolified array of ordinal patterns.</p>
<p>Each data vector (X_t, …, X_t+(dim-1)*step) is converted to its rank
vector. E.g., (0.2, -.6, 1.2) –&gt; (1,0,2) which is then assigned to a
unique integer (see Article). There are faculty(dim) possible rank vectors.</p>
<p>Note that the symb_array is step*(dim-1) shorter than the original array!</p>
<p>Reference: B. Pompe and J. Runge (2011). Momentary information transfer as
a coupling measure of time series. Phys. Rev. E, 83(5), 1-12.
doi:10.1103/PhysRevE.83.051122</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>array</strong> (<em>array-like</em>) – Data array of shape (time, variables).</li>
<li><strong>array_mask</strong> (<em>bool array</em>) – Data mask where True labels masked samples.</li>
<li><strong>dim</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 2</em><em>)</em>) – Pattern dimension</li>
<li><strong>step</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 1</em><em>)</em>) – Delay of pattern embedding vector.</li>
<li><strong>weights</strong> (<em>bool</em><em>, </em><em>optional</em><em> (</em><em>default: False</em><em>)</em>) – Whether to return array of variances of embedding vectors as weights.</li>
<li><strong>verbosity</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 0</em><em>)</em>) – Level of verbosity.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>patt, patt_mask [, patt_time]</strong> – Tuple of converted pattern array and new length</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple of arrays</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tigramite.data_processing.quantile_bin_array">
<code class="descclassname">tigramite.data_processing.</code><code class="descname">quantile_bin_array</code><span class="sig-paren">(</span><em>data</em>, <em>bins=6</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.data_processing.quantile_bin_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns symbolified array with equal-quantile binning.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<em>array</em>) – Data array of shape (time, variables).</li>
<li><strong>bins</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 6</em><em>)</em>) – Number of bins.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>symb_array</strong> – Converted data of integer type.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tigramite.data_processing.smooth">
<code class="descclassname">tigramite.data_processing.</code><code class="descname">smooth</code><span class="sig-paren">(</span><em>data</em>, <em>smooth_width</em>, <em>kernel='gaussian'</em>, <em>mask=None</em>, <em>residuals=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.data_processing.smooth" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns either smoothed time series or its residuals.</p>
<p>the difference between the original and the smoothed time series
(=residuals) of a kernel smoothing with gaussian (smoothing kernel width =
twice the sigma!) or heaviside window, equivalent to a running mean.</p>
<p>Assumes data of shape (T, N) or (T,)
:rtype: array
:returns: smoothed/residual data</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<em>array</em>) – Data array of shape (time, variables).</li>
<li><strong>smooth_width</strong> (<em>float</em>) – Window width of smoothing, 2*sigma for a gaussian.</li>
<li><strong>kernel</strong> (<em>str</em><em>, </em><em>optional</em><em> (</em><em>default: 'gaussian'</em><em>)</em>) – Smoothing kernel, ‘gaussian’ or ‘heaviside’ for a running mean.</li>
<li><strong>mask</strong> (<em>bool array</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Data mask where True labels masked samples.</li>
<li><strong>residuals</strong> (<em>bool</em><em>, </em><em>optional</em><em> (</em><em>default: False</em><em>)</em>) – True if residuals should be returned instead of smoothed data.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>data</strong> – Smoothed/residual data.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array-like</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tigramite.data_processing.time_bin_with_mask">
<code class="descclassname">tigramite.data_processing.</code><code class="descname">time_bin_with_mask</code><span class="sig-paren">(</span><em>data</em>, <em>time_bin_length</em>, <em>sample_selector=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.data_processing.time_bin_with_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns time binned data where only about non-masked values is averaged.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<em>array</em>) – Data array of shape (time, variables).</li>
<li><strong>time_bin_length</strong> (<em>int</em>) – Length of time bin.</li>
<li><strong>mask</strong> (<em>bool array</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Data mask where True labels masked samples.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>(bindata, T)</strong> – Tuple of time-binned data array and new length of array.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple of array and int</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tigramite.data_processing.var_process">
<code class="descclassname">tigramite.data_processing.</code><code class="descname">var_process</code><span class="sig-paren">(</span><em>parents_neighbors_coeffs</em>, <em>T=1000</em>, <em>use='inv_inno_cov'</em>, <em>verbosity=0</em>, <em>initial_values=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.data_processing.var_process" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a vector-autoregressive process with correlated innovations.</p>
<p>Wrapper around var_network with possibly more user-friendly input options.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>parents_neighbors_coeffs</strong> (<em>dict</em>) – <dl class="docutils">
<dt>Dictionary of format:</dt>
<dd>{…, j:[((var1, lag1), coef1), ((var2, lag2), coef2), …], …}</dd>
</dl>
<p>for all variables where vars must be in [0..N-1] and lags &lt;= 0 with
number of variables N. If lag=0, a nonzero value in the covariance
matrix (or its inverse) is implied. These should be the same for (i, j)
and (j, i).</p>
</li>
<li><strong>use</strong> (<em>str</em><em>, </em><em>optional</em><em> (</em><em>default: 'inv_inno_cov'</em><em>)</em>) – Specifier, either ‘inno_cov’ or ‘inv_inno_cov’.
Any other specifier will result in non-correlated noise.
For debugging, ‘no_noise’ can also be specified, in which case random
noise will be disabled.</li>
<li><strong>T</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 1000</em><em>)</em>) – Sample size.</li>
<li><strong>verbosity</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 0</em><em>)</em>) – Level of verbosity.</li>
<li><strong>initial_values</strong> (<em>array</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Initial values for each node. Shape must be (N, max_delay+1)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>data</strong> (<em>array-like</em>) – Data generated from this process</li>
<li><strong>true_parent_neighbor</strong> (<em>dict</em>) – Dictionary of lists of tuples.  The dictionary is keyed by node ID, the
list stores the tuple values (parent_node_id, time_lag)</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tigramite.data_processing.weighted_avg_and_std">
<code class="descclassname">tigramite.data_processing.</code><code class="descname">weighted_avg_and_std</code><span class="sig-paren">(</span><em>values</em>, <em>axis</em>, <em>weights</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.data_processing.weighted_avg_and_std" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the weighted average and standard deviation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>values</strong> (<em>array</em>) – Data array of shape (time, variables).</li>
<li><strong>axis</strong> (<em>int</em>) – Axis to average/std about</li>
<li><strong>weights</strong> (<em>array</em>) – Weight array of shape (time, variables).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>(average, std)</strong> – Tuple of weighted average and standard deviation along axis.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple of arrays</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="tigramite-models-time-series-modeling-mediation-and-prediction">
<h1><code class="xref py py-mod docutils literal notranslate"><span class="pre">tigramite.models</span></code>: Time series modeling, mediation, and prediction<a class="headerlink" href="#tigramite-models-time-series-modeling-mediation-and-prediction" title="Permalink to this headline">¶</a></h1>
<p>Base class:</p>
<dl class="class">
<dt id="tigramite.models.Models">
<em class="property">class </em><code class="descclassname">tigramite.models.</code><code class="descname">Models</code><span class="sig-paren">(</span><em>dataframe</em>, <em>model</em>, <em>data_transform=StandardScaler(copy=True</em>, <em>with_mean=True</em>, <em>with_std=True)</em>, <em>mask_type=None</em>, <em>verbosity=0</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.models.Models" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for time series models.</p>
<p>Allows to fit any model from sklearn to the parents of a target variable.
Also takes care of missing values, masking and preprocessing.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dataframe</strong> (<em>data object</em>) – Tigramite dataframe object. It must have the attributes dataframe.values
yielding a numpy array of shape (observations T, variables N) and
optionally a mask of the same shape and a missing values flag.</li>
<li><strong>model</strong> (<em>sklearn model object</em>) – For example, sklearn.linear_model.LinearRegression() for a linear
regression model.</li>
<li><strong>data_transform</strong> (<em>sklearn preprocessing object</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Used to transform data prior to fitting. For example,
sklearn.preprocessing.StandardScaler for simple standardization. The
fitted parameters are stored.</li>
<li><strong>mask_type</strong> (<em>{'y'</em><em>,</em><em>'x'</em><em>,</em><em>'z'</em><em>,</em><em>'xy'</em><em>,</em><em>'xz'</em><em>,</em><em>'yz'</em><em>,</em><em>'xyz'}</em>) – Masking mode: Indicators for which variables in the dependence measure
I(X; Y | Z) the samples should be masked. If None, ‘y’ is used, which
excludes all time slices containing masked samples in Y. Explained in
<a class="footnote-reference" href="#id5" id="id25">[1]</a>.</li>
<li><strong>verbosity</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 0</em><em>)</em>) – Level of verbosity.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tigramite.models.Models.get_coefs">
<code class="descname">get_coefs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.models.Models.get_coefs" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns dictionary of coefficients for linear models.</p>
<p>Only for models from sklearn.linear_model</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>coeffs</strong> – Dictionary of dictionaries for each variable with keys given by the
parents and the regression coefficients as values.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">dictionary</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tigramite.models.Models.get_fit">
<code class="descname">get_fit</code><span class="sig-paren">(</span><em>all_parents</em>, <em>selected_variables=None</em>, <em>tau_max=None</em>, <em>cut_off='max_lag_or_tau_max'</em>, <em>return_data=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.models.Models.get_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit time series model.</p>
<p>For each variable in selected_variables, the sklearn model is fitted
with <img class="math" src="_images/math/276f7e256cbddeb81eee42e1efc348f3cb4ab5f8.png" alt="y"/> given by the target variable, and <img class="math" src="_images/math/7a7bb470119808e2db2879fc2b2526f467b7a40b.png" alt="X"/> given by its
parents. The fitted model class is returned for later use.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>all_parents</strong> (<em>dictionary</em>) – Dictionary of form {0:[(0, -1), (3, -2), …], 1:[], …} containing
the parents estimated with PCMCI.</li>
<li><strong>selected_variables</strong> (<em>list of integers</em><em>, </em><em>optional</em><em> (</em><em>default: range</em><em>(</em><em>N</em><em>)</em><em>)</em>) – Specify to estimate parents only for selected variables. If None is
passed, parents are estimated for all variables.</li>
<li><strong>tau_max</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Maximum time lag. If None, the maximum lag in all_parents is used.</li>
<li><strong>cut_off</strong> (<em>{'2xtau_max'</em><em>, </em><em>'max_lag'</em><em>, </em><em>'max_lag_or_tau_max'}</em>) – How many samples to cutoff at the beginning. The default is
‘max_lag_or_tau_max’, which uses the maximum of tau_max and the
conditions. This is useful to compare multiple models on the same
sample. Other options are ‘2xtau_max’, which guarantees that MCI
tests are all conducted on the same samples.  For modeling, can be
used, Last, ‘max_lag’ uses as much samples as possible.</li>
<li><strong>return_data</strong> (<em>bool</em><em>, </em><em>optional</em><em> (</em><em>default: False</em><em>)</em>) – Whether to save the data array.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>fit_results</strong> – Returns the sklearn model after fitting. Also returns the data
transformation parameters.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dictionary of sklearn model objects for each variable</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<p>Derived classes:</p>
<dl class="class">
<dt id="tigramite.models.LinearMediation">
<em class="property">class </em><code class="descclassname">tigramite.models.</code><code class="descname">LinearMediation</code><span class="sig-paren">(</span><em>dataframe</em>, <em>model_params=None</em>, <em>data_transform=StandardScaler(copy=True</em>, <em>with_mean=True</em>, <em>with_std=True)</em>, <em>mask_type=None</em>, <em>verbosity=0</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.models.LinearMediation" title="Permalink to this definition">¶</a></dt>
<dd><p>Linear mediation analysis for time series models.</p>
<p>Fits linear model to parents and provides functions to return measures such
as causal effect, mediated causal effect, average causal effect, etc. as
described in <a class="footnote-reference" href="#id28" id="id26">[4]</a>.</p>
<p class="rubric">Notes</p>
<p>This class implements the following causal mediation measures introduced in
<a class="footnote-reference" href="#id28" id="id27">[4]</a>:</p>
<blockquote>
<div><ul class="simple">
<li>causal effect (CE)</li>
<li>mediated causal effect (MCE)</li>
<li>average causal effect (ACE)</li>
<li>average causal susceptibility (ACS)</li>
<li>average mediated causal effect (AMCE)</li>
</ul>
</div></blockquote>
<p>Consider a simple model of a causal chain as given in the Example with</p>
<div class="math">
<p><img src="_images/math/90efcfdee16eaaec575238e2e6df5f731c8609bf.png" alt="X_t &amp;= \eta^X_t \\
Y_t &amp;= 0.5 X_{t-1} +  \eta^Y_t \\
Z_t &amp;= 0.5 Y_{t-1} +  \eta^Z_t"/></p>
</div><p>Here the link coefficient of <img class="math" src="_images/math/5c8ff70420eb65f959d5e2a9b244fc565d9ecbd6.png" alt="X_{t-2} \to Z_t"/> is zero while the
causal effect is 0.25. MCE through <img class="math" src="_images/math/0062c26909b3e07ee8f5a6285b2563d69bc979ff.png" alt="Y"/> is 0.25 implying that <em>all</em>
of the the CE is explained by <img class="math" src="_images/math/0062c26909b3e07ee8f5a6285b2563d69bc979ff.png" alt="Y"/>. ACE from <img class="math" src="_images/math/7a7bb470119808e2db2879fc2b2526f467b7a40b.png" alt="X"/> is 0.37 since it
has CE 0.5 on <img class="math" src="_images/math/0062c26909b3e07ee8f5a6285b2563d69bc979ff.png" alt="Y"/> and 0.25 on <img class="math" src="_images/math/bcb2457ac9d8995a4f34d57cadac7ecbbe58f3bd.png" alt="Z"/>.</p>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">links_coeffs</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">[],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[((</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="mf">0.5</span><span class="p">)],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[((</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="mf">0.5</span><span class="p">)]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">,</span> <span class="n">true_parents</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">var_process</span><span class="p">(</span><span class="n">links_coeffs</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataframe</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">med</span> <span class="o">=</span> <span class="n">LinearMediation</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">dataframe</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">med</span><span class="o">.</span><span class="n">fit_model</span><span class="p">(</span><span class="n">all_parents</span><span class="o">=</span><span class="n">true_parents</span><span class="p">,</span> <span class="n">tau_max</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="s2">&quot;Link coefficient (0, -2) --&gt; 2: &quot;</span><span class="p">,</span> <span class="n">med</span><span class="o">.</span><span class="n">get_coeff</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">tau</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="s2">&quot;Causal effect (0, -2) --&gt; 2: &quot;</span><span class="p">,</span> <span class="n">med</span><span class="o">.</span><span class="n">get_ce</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">tau</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="s2">&quot;Mediated Causal effect (0, -2) --&gt; 2 through 1: &quot;</span><span class="p">,</span> <span class="n">med</span><span class="o">.</span><span class="n">get_mce</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">tau</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="s2">&quot;Average Causal Effect: &quot;</span><span class="p">,</span> <span class="n">med</span><span class="o">.</span><span class="n">get_all_ace</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="s2">&quot;Average Causal Susceptibility: &quot;</span><span class="p">,</span> <span class="n">med</span><span class="o">.</span><span class="n">get_all_acs</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="s2">&quot;Average Mediated Causal Effect: &quot;</span><span class="p">,</span> <span class="n">med</span><span class="o">.</span><span class="n">get_all_amce</span><span class="p">()</span>
<span class="go">Link coefficient (0, -2) --&gt; 2:  0.0</span>
<span class="go">Causal effect (0, -2) --&gt; 2:  0.250648072987</span>
<span class="go">Mediated Causal effect (0, -2) --&gt; 2 through 1:  0.250648072987</span>
<span class="go">Average Causal Effect:  [ 0.36897445  0.25718002  0.        ]</span>
<span class="go">Average Causal Susceptibility:  [ 0.          0.24365041  0.38250406]</span>
<span class="go">Average Mediated Causal Effect:  [ 0.          0.12532404  0.        ]</span>
</pre></div>
</div>
<p class="rubric">References</p>
<table class="docutils footnote" frame="void" id="id28" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[4]</td><td><em>(<a class="fn-backref" href="#id26">1</a>, <a class="fn-backref" href="#id27">2</a>, <a class="fn-backref" href="#id30">3</a>)</em> J. Runge et al. (2015): Identifying causal gateways and mediators in
complex spatio-temporal systems.
Nature Communications, 6, 8502. <a class="reference external" href="http://doi.org/10.1038/ncomms9502">http://doi.org/10.1038/ncomms9502</a></td></tr>
</tbody>
</table>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dataframe</strong> (<em>data object</em>) – Tigramite dataframe object. It must have the attributes dataframe.values
yielding a numpy array of shape (observations T, variables N) and
optionally a mask of the same shape and a missing values flag.</li>
<li><strong>model_params</strong> (<em>dictionary</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Optional parameters passed on to sklearn model</li>
<li><strong>data_transform</strong> (<em>sklearn preprocessing object</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Used to transform data prior to fitting. For example,
sklearn.preprocessing.StandardScaler for simple standardization. The
fitted parameters are stored.</li>
<li><strong>mask_type</strong> (<em>{'y'</em><em>,</em><em>'x'</em><em>,</em><em>'z'</em><em>,</em><em>'xy'</em><em>,</em><em>'xz'</em><em>,</em><em>'yz'</em><em>,</em><em>'xyz'}</em>) – Masking mode: Indicators for which variables in the dependence measure
I(X; Y | Z) the samples should be masked. If None, ‘y’ is used, which
excludes all time slices containing masked samples in Y. Explained in
<a class="footnote-reference" href="#id5" id="id29">[1]</a>.</li>
<li><strong>verbosity</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 0</em><em>)</em>) – Level of verbosity.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tigramite.models.LinearMediation.fit_model">
<code class="descname">fit_model</code><span class="sig-paren">(</span><em>all_parents</em>, <em>tau_max=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.models.LinearMediation.fit_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit linear time series model.</p>
<p>Fits a sklearn.linear_model.LinearRegression model to the parents of
each variable and computes the coefficient matrices <img class="math" src="_images/math/e486de19dbb61c9a63584f6e4ddd6e92ef03d665.png" alt="\Phi"/> and
<img class="math" src="_images/math/334b0728f25dd84a28e483181038a307ea6e483e.png" alt="\Psi"/> as described in <a class="footnote-reference" href="#id28" id="id30">[4]</a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>all_parents</strong> (<em>dictionary</em>) – Dictionary of form {0:[(0, -1), (3, -2), …], 1:[], …} containing
the parents estimated with PCMCI.</li>
<li><strong>tau_max</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Maximum time lag. If None, the maximum lag in all_parents is used.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tigramite.models.LinearMediation.get_ace">
<code class="descname">get_ace</code><span class="sig-paren">(</span><em>i</em>, <em>lag_mode='absmax'</em>, <em>exclude_i=True</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.models.LinearMediation.get_ace" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the average causal effect.</p>
<p>This is the average causal effect (ACE) emanating from variable i to any
other variable. With lag_mode=’absmax’ this is based on the lag of
maximum CE for each pair.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>i</strong> (<em>int</em>) – Index of cause variable.</li>
<li><strong>lag_mode</strong> (<em>{'absmax'</em><em>, </em><em>'all_lags'}</em>) – Lag mode. Either average across all lags between each pair or only
at the lag of maximum absolute causal effect.</li>
<li><strong>exclude_i</strong> (<em>bool</em><em>, </em><em>optional</em><em> (</em><em>default: True</em><em>)</em>) – Whether to exclude causal effects on the variable itself at later
lags.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>ace</strong> – Average Causal Effect.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tigramite.models.LinearMediation.get_acs">
<code class="descname">get_acs</code><span class="sig-paren">(</span><em>j</em>, <em>lag_mode='absmax'</em>, <em>exclude_j=True</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.models.LinearMediation.get_acs" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the average causal susceptibility.</p>
<p>This is the Average Causal Susceptibility (ACS) affecting a variable j
from any other variable. With lag_mode=’absmax’ this is based on the lag
of maximum CE for each pair.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>j</strong> (<em>int</em>) – Index of variable.</li>
<li><strong>lag_mode</strong> (<em>{'absmax'</em><em>, </em><em>'all_lags'}</em>) – Lag mode. Either average across all lags between each pair or only
at the lag of maximum absolute causal effect.</li>
<li><strong>exclude_j</strong> (<em>bool</em><em>, </em><em>optional</em><em> (</em><em>default: True</em><em>)</em>) – Whether to exclude causal effects on the variable itself at previous
lags.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>acs</strong> – Average Causal Susceptibility.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tigramite.models.LinearMediation.get_all_ace">
<code class="descname">get_all_ace</code><span class="sig-paren">(</span><em>lag_mode='absmax'</em>, <em>exclude_i=True</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.models.LinearMediation.get_all_ace" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the average causal effect for all variables.</p>
<p>This is the average causal effect (ACE) emanating from variable i to any
other variable. With lag_mode=’absmax’ this is based on the lag of
maximum CE for each pair.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>lag_mode</strong> (<em>{'absmax'</em><em>, </em><em>'all_lags'}</em>) – Lag mode. Either average across all lags between each pair or only
at the lag of maximum absolute causal effect.</li>
<li><strong>exclude_i</strong> (<em>bool</em><em>, </em><em>optional</em><em> (</em><em>default: True</em><em>)</em>) – Whether to exclude causal effects on the variable itself at later
lags.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>ace</strong> – Average Causal Effect for each variable.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array of shape (N,)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tigramite.models.LinearMediation.get_all_acs">
<code class="descname">get_all_acs</code><span class="sig-paren">(</span><em>lag_mode='absmax'</em>, <em>exclude_j=True</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.models.LinearMediation.get_all_acs" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the average causal susceptibility.</p>
<p>This is the Average Causal Susceptibility (ACS) for each variable from
any other variable. With lag_mode=’absmax’ this is based on the lag of
maximum CE for each pair.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>lag_mode</strong> (<em>{'absmax'</em><em>, </em><em>'all_lags'}</em>) – Lag mode. Either average across all lags between each pair or only
at the lag of maximum absolute causal effect.</li>
<li><strong>exclude_j</strong> (<em>bool</em><em>, </em><em>optional</em><em> (</em><em>default: True</em><em>)</em>) – Whether to exclude causal effects on the variable itself at previous
lags.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>acs</strong> – Average Causal Susceptibility.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array of shape (N,)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tigramite.models.LinearMediation.get_all_amce">
<code class="descname">get_all_amce</code><span class="sig-paren">(</span><em>lag_mode='absmax'</em>, <em>exclude_k=True</em>, <em>exclude_self_effects=True</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.models.LinearMediation.get_all_amce" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the average mediated causal effect.</p>
<p>This is the Average Mediated Causal Effect (AMCE) through all variables
With lag_mode=’absmax’ this is based on the lag of maximum CE for each
pair.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>lag_mode</strong> (<em>{'absmax'</em><em>, </em><em>'all_lags'}</em>) – Lag mode. Either average across all lags between each pair or only
at the lag of maximum absolute causal effect.</li>
<li><strong>exclude_k</strong> (<em>bool</em><em>, </em><em>optional</em><em> (</em><em>default: True</em><em>)</em>) – Whether to exclude causal effects through the variable itself at
previous lags.</li>
<li><strong>exclude_self_effects</strong> (<em>bool</em><em>, </em><em>optional</em><em> (</em><em>default: True</em><em>)</em>) – Whether to exclude causal self effects of variables on themselves.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>amce</strong> – Average Mediated Causal Effect.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array of shape (N,)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tigramite.models.LinearMediation.get_amce">
<code class="descname">get_amce</code><span class="sig-paren">(</span><em>k</em>, <em>lag_mode='absmax'</em>, <em>exclude_k=True</em>, <em>exclude_self_effects=True</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.models.LinearMediation.get_amce" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the average mediated causal effect.</p>
<p>This is the Average Mediated Causal Effect (AMCE) through a variable k
With lag_mode=’absmax’ this is based on the lag of maximum CE for each
pair.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>k</strong> (<em>int</em>) – Index of variable.</li>
<li><strong>lag_mode</strong> (<em>{'absmax'</em><em>, </em><em>'all_lags'}</em>) – Lag mode. Either average across all lags between each pair or only
at the lag of maximum absolute causal effect.</li>
<li><strong>exclude_k</strong> (<em>bool</em><em>, </em><em>optional</em><em> (</em><em>default: True</em><em>)</em>) – Whether to exclude causal effects through the variable itself at
previous lags.</li>
<li><strong>exclude_self_effects</strong> (<em>bool</em><em>, </em><em>optional</em><em> (</em><em>default: True</em><em>)</em>) – Whether to exclude causal self effects of variables on themselves.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>amce</strong> – Average Mediated Causal Effect.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tigramite.models.LinearMediation.get_ce">
<code class="descname">get_ce</code><span class="sig-paren">(</span><em>i</em>, <em>tau</em>, <em>j</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.models.LinearMediation.get_ce" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the causal effect.</p>
<p>This is the causal effect for  (i, tau) – –&gt; j.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>i</strong> (<em>int</em>) – Index of cause variable.</li>
<li><strong>tau</strong> (<em>int</em>) – Lag of cause variable.</li>
<li><strong>j</strong> (<em>int</em>) – Index of effect variable.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>ce</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tigramite.models.LinearMediation.get_ce_max">
<code class="descname">get_ce_max</code><span class="sig-paren">(</span><em>i</em>, <em>j</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.models.LinearMediation.get_ce_max" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the causal effect.</p>
<p>This is the maximum absolute causal effect for  i –&gt; j across all lags.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>i</strong> (<em>int</em>) – Index of cause variable.</li>
<li><strong>j</strong> (<em>int</em>) – Index of effect variable.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>ce</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tigramite.models.LinearMediation.get_coeff">
<code class="descname">get_coeff</code><span class="sig-paren">(</span><em>i</em>, <em>tau</em>, <em>j</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.models.LinearMediation.get_coeff" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns link coefficient.</p>
<p>This is the causal effect for a particular link (i, tau) –&gt; j.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>i</strong> (<em>int</em>) – Index of cause variable.</li>
<li><strong>tau</strong> (<em>int</em>) – Lag of cause variable.</li>
<li><strong>j</strong> (<em>int</em>) – Index of effect variable.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>coeff</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tigramite.models.LinearMediation.get_mce">
<code class="descname">get_mce</code><span class="sig-paren">(</span><em>i</em>, <em>tau</em>, <em>j</em>, <em>k</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.models.LinearMediation.get_mce" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the mediated causal effect.</p>
<p>This is the causal effect for  i –&gt; j minus the causal effect not going
through k.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>i</strong> (<em>int</em>) – Index of cause variable.</li>
<li><strong>tau</strong> (<em>int</em>) – Lag of cause variable.</li>
<li><strong>j</strong> (<em>int</em>) – Index of effect variable.</li>
<li><strong>k</strong> (<em>int</em>) – Index of mediator variable.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>mce</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tigramite.models.LinearMediation.get_mediation_graph_data">
<code class="descname">get_mediation_graph_data</code><span class="sig-paren">(</span><em>i</em>, <em>tau</em>, <em>j</em>, <em>include_neighbors=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.models.LinearMediation.get_mediation_graph_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns link and node weights for mediation analysis.</p>
<p>Returns array with non-zero entries for links that are on causal
paths between <img class="math" src="_images/math/df0deb143e5ac127f00bd248ee8001ecae572adc.png" alt="i"/> and <img class="math" src="_images/math/6b21e0b0899a0d2879d3b8019087fa630bab4ea2.png" alt="j"/> at lag <img class="math" src="_images/math/557d5fad862c9046d26e1a930f45a550c146d592.png" alt="\tau"/>.
<code class="docutils literal notranslate"><span class="pre">path_val_matrix</span></code> contains the corresponding path coefficients and
<code class="docutils literal notranslate"><span class="pre">path_node_array</span></code> the MCE values. <code class="docutils literal notranslate"><span class="pre">tsg_path_val_matrix</span></code> contains the
corresponding values in the time series graph format.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>i</strong> (<em>int</em>) – Index of cause variable.</li>
<li><strong>tau</strong> (<em>int</em>) – Lag of cause variable.</li>
<li><strong>j</strong> (<em>int</em>) – Index of effect variable.</li>
<li><strong>include_neighbors</strong> (<em>bool</em><em>, </em><em>optional</em><em> (</em><em>default: False</em><em>)</em>) – Whether to include causal paths emanating from neighbors of i</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>graph_data</strong> – Dictionary of matrices for coloring mediation graph plots.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dictionary</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tigramite.models.LinearMediation.get_tsg">
<code class="descname">get_tsg</code><span class="sig-paren">(</span><em>link_matrix</em>, <em>val_matrix=None</em>, <em>include_neighbors=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.models.LinearMediation.get_tsg" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns time series graph matrix.</p>
<p>Constructs a matrix of shape (N*tau_max, N*tau_max) from link_matrix.
This matrix can be used for plotting the time series graph and analyzing
causal pathways.</p>
<dl class="docutils">
<dt>link_matrix <span class="classifier-delimiter">:</span> <span class="classifier">bool array-like, optional (default: None)</span></dt>
<dd>Matrix of significant links. Must be of same shape as val_matrix. Either
sig_thres or link_matrix has to be provided.</dd>
<dt>val_matrix <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd>Matrix of shape (N, N, tau_max+1) containing test statistic values.</dd>
<dt>include_neighbors <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional (default: False)</span></dt>
<dd>Whether to include causal paths emanating from neighbors of i</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>tsg</strong> – Time series graph matrix.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">array of shape (N*tau_max, N*tau_max)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tigramite.models.LinearMediation.get_val_matrix">
<code class="descname">get_val_matrix</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.models.LinearMediation.get_val_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the matrix of linear coefficients.</p>
<p>Format is val_matrix[i, j, tau] denotes coefficient of link
i –tau–&gt; j.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>val_matrix</strong> – Matrix of linear coefficients, shape (N, N, tau_max + 1).</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">array</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tigramite.models.LinearMediation.net_to_tsg">
<code class="descname">net_to_tsg</code><span class="sig-paren">(</span><em>row</em>, <em>lag</em>, <em>max_lag</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.models.LinearMediation.net_to_tsg" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to translate from network to time series graph.</p>
</dd></dl>

<dl class="method">
<dt id="tigramite.models.LinearMediation.tsg_to_net">
<code class="descname">tsg_to_net</code><span class="sig-paren">(</span><em>node</em>, <em>max_lag</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.models.LinearMediation.tsg_to_net" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to translate from time series graph to network.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tigramite.models.Prediction">
<em class="property">class </em><code class="descclassname">tigramite.models.</code><code class="descname">Prediction</code><span class="sig-paren">(</span><em>dataframe</em>, <em>train_indices</em>, <em>test_indices</em>, <em>prediction_model</em>, <em>cond_ind_test=None</em>, <em>data_transform=None</em>, <em>verbosity=0</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.models.Prediction" title="Permalink to this definition">¶</a></dt>
<dd><p>Prediction class for time series models.</p>
<p>Allows to fit and predict from any sklearn model. The optimal predictors can
be estimated using PCMCI. Also takes care of missing values, masking and
preprocessing.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dataframe</strong> (<em>data object</em>) – Tigramite dataframe object. It must have the attributes dataframe.values
yielding a numpy array of shape (observations T, variables N) and
optionally a mask of the same shape and a missing values flag.</li>
<li><strong>train_indices</strong> (<em>array-like</em>) – Either boolean array or time indices marking the training data.</li>
<li><strong>test_indices</strong> (<em>array-like</em>) – Either boolean array or time indices marking the test data.</li>
<li><strong>prediction_model</strong> (<em>sklearn model object</em>) – For example, sklearn.linear_model.LinearRegression() for a linear
regression model.</li>
<li><strong>cond_ind_test</strong> (<em>Conditional independence test object</em><em>, </em><em>optional</em>) – Only needed if predictors are estimated with causal algorithm.
The class will be initialized with masking set to the training data.</li>
<li><strong>data_transform</strong> (<em>sklearn preprocessing object</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Used to transform data prior to fitting. For example,
sklearn.preprocessing.StandardScaler for simple standardization. The
fitted parameters are stored.</li>
<li><strong>verbosity</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 0</em><em>)</em>) – Level of verbosity.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tigramite.models.Prediction.fit">
<code class="descname">fit</code><span class="sig-paren">(</span><em>target_predictors</em>, <em>selected_targets=None</em>, <em>tau_max=None</em>, <em>return_data=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.models.Prediction.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit time series model.</p>
<p>Wrapper around <code class="docutils literal notranslate"><span class="pre">Models.get_fit()</span></code>. To each variable in
<code class="docutils literal notranslate"><span class="pre">selected_targets</span></code>, the sklearn model is fitted with <img class="math" src="_images/math/276f7e256cbddeb81eee42e1efc348f3cb4ab5f8.png" alt="y"/> given
by the target variable, and <img class="math" src="_images/math/7a7bb470119808e2db2879fc2b2526f467b7a40b.png" alt="X"/> given by its predictors. The
fitted model class is returned for later use.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>target_predictors</strong> (<em>dictionary</em>) – Dictionary of form {0:[(0, -1), (3, -2), …], 1:[], …} containing
the predictors estimated with PCMCI.</li>
<li><strong>selected_targets</strong> (<em>list of integers</em><em>, </em><em>optional</em><em> (</em><em>default: range</em><em>(</em><em>N</em><em>)</em><em>)</em>) – Specify to fit model only for selected targets. If None is
passed, models are estimated for all variables.</li>
<li><strong>tau_max</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Maximum time lag. If None, the maximum lag in target_predictors is
used.</li>
<li><strong>return_data</strong> (<em>bool</em><em>, </em><em>optional</em><em> (</em><em>default: False</em><em>)</em>) – Whether to save the data array.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>self</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">instance of self</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tigramite.models.Prediction.get_predictors">
<code class="descname">get_predictors</code><span class="sig-paren">(</span><em>selected_targets=None</em>, <em>selected_links=None</em>, <em>steps_ahead=1</em>, <em>tau_max=1</em>, <em>pc_alpha=0.2</em>, <em>max_conds_dim=None</em>, <em>max_combinations=1</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.models.Prediction.get_predictors" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate predictors using PC1 algorithm.</p>
<p>Wrapper around PCMCI.run_pc_stable that estimates causal predictors.
The lead time can be specified by <code class="docutils literal notranslate"><span class="pre">steps_ahead</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>selected_targets</strong> (<em>list of ints</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – List of variables to estimate predictors of. If None, predictors of
all variables are estimated.</li>
<li><strong>selected_links</strong> (<em>dict</em><em> or </em><em>None</em>) – Dictionary of form {0:[(0, -1), (3, -2), …], 1:[], …}
specifying whether only selected links should be tested. If None is
passed, all links are tested</li>
<li><strong>steps_ahead</strong> (<em>int</em><em>, </em><em>default: 1</em>) – Minimum time lag to test. Useful for multi-step ahead predictions.</li>
<li><strong>tau_max</strong> (<em>int</em><em>, </em><em>default: 1</em>) – Maximum time lag. Must be larger or equal to tau_min.</li>
<li><strong>pc_alpha</strong> (<em>float</em><em> or </em><em>list of floats</em><em>, </em><em>default: 0.2</em>) – Significance level in algorithm. If a list or None is passed, the
pc_alpha level is optimized for every variable across the given
pc_alpha values using the score computed in
cond_ind_test.get_model_selection_criterion()</li>
<li><strong>max_conds_dim</strong> (<em>int</em><em> or </em><em>None</em>) – Maximum number of conditions to test. If None is passed, this number
is unrestricted.</li>
<li><strong>max_combinations</strong> (<em>int</em><em>, </em><em>default: 1</em>) – Maximum number of combinations of conditions of current cardinality
to test. Defaults to 1 for PC_1 algorithm. For original PC algorithm
a larger number, such as 10, can be used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>predictors</strong> – Dictionary of form {0:[(0, -1), (3, -2), …], 1:[], …}
containing estimated predictors.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tigramite.models.Prediction.get_test_array">
<code class="descname">get_test_array</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.models.Prediction.get_test_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns test array.</p>
</dd></dl>

<dl class="method">
<dt id="tigramite.models.Prediction.get_train_array">
<code class="descname">get_train_array</code><span class="sig-paren">(</span><em>j</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.models.Prediction.get_train_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns training array.</p>
</dd></dl>

<dl class="method">
<dt id="tigramite.models.Prediction.predict">
<code class="descname">predict</code><span class="sig-paren">(</span><em>target</em>, <em>new_data=None</em>, <em>pred_params=None</em>, <em>cut_off='max_lag_or_tau_max'</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.models.Prediction.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict target variable with fitted model.</p>
<p>Uses the model.predict() function of the sklearn model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>target</strong> (<em>int</em>) – Index of target variable.</li>
<li><strong>new_data</strong> (<em>data object</em><em>, </em><em>optional</em>) – New Tigramite dataframe object with optional new mask.</li>
<li><strong>pred_params</strong> (<em>dict</em><em>, </em><em>optional</em>) – Optional parameters passed on to sklearn prediction function.</li>
<li><strong>cut_off</strong> (<em>{'2xtau_max'</em><em>, </em><em>'max_lag'</em><em>, </em><em>'max_lag_or_tau_max'}</em>) – How many samples to cutoff at the beginning. The default is
‘2xtau_max’, which guarantees that MCI tests are all conducted on
the same samples.  For modeling, ‘max_lag_or_tau_max’ can be used,
which uses the maximum of tau_max and the conditions, which is
useful to compare multiple models on the same sample. Last,
‘max_lag’ uses as much samples as possible.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Results from prediction.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-tigramite.plotting">
<span id="tigramite-plotting-plotting-functions"></span><h1><a class="reference internal" href="#module-tigramite.plotting" title="tigramite.plotting"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tigramite.plotting</span></code></a>: Plotting functions<a class="headerlink" href="#module-tigramite.plotting" title="Permalink to this headline">¶</a></h1>
<p>Tigramite plotting package.</p>
<dl class="function">
<dt id="tigramite.plotting.plot_graph">
<code class="descclassname">tigramite.plotting.</code><code class="descname">plot_graph</code><span class="sig-paren">(</span><em>val_matrix</em>, <em>var_names=None</em>, <em>fig_ax=None</em>, <em>figsize=None</em>, <em>sig_thres=None</em>, <em>link_matrix=None</em>, <em>save_name=None</em>, <em>link_colorbar_label='MCI'</em>, <em>node_colorbar_label='auto-MCI'</em>, <em>link_width=None</em>, <em>link_attribute=None</em>, <em>node_pos=None</em>, <em>arrow_linewidth=30.0</em>, <em>vmin_edges=-1</em>, <em>vmax_edges=1.0</em>, <em>edge_ticks=0.4</em>, <em>cmap_edges='RdBu_r'</em>, <em>vmin_nodes=0</em>, <em>vmax_nodes=1.0</em>, <em>node_ticks=0.4</em>, <em>cmap_nodes='OrRd'</em>, <em>node_size=20</em>, <em>arrowhead_size=20</em>, <em>curved_radius=0.2</em>, <em>label_fontsize=10</em>, <em>alpha=1.0</em>, <em>node_label_size=10</em>, <em>link_label_fontsize=6</em>, <em>lag_array=None</em>, <em>network_lower_bound=0.2</em>, <em>show_colorbar=True</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.plotting.plot_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a network plot.</p>
<p>This is still in beta. The network is defined either from True values in
link_matrix, or from thresholding the val_matrix with sig_thres.  Nodes
denote variables, straight links contemporaneous dependencies and curved
arrows lagged dependencies. The node color denotes the maximal absolute
auto-dependency and the link color the value at the lag with maximal
absolute cross-dependency. The link label lists the lags with significant
dependency in order of absolute magnitude. The network can also be plotted
over a map drawn before on the same axis. Then the node positions can be
supplied in appropriate axis coordinates via node_pos.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>val_matrix</strong> (<em>array_like</em>) – Matrix of shape (N, N, tau_max+1) containing test statistic values.</li>
<li><strong>var_names</strong> (<em>list</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – List of variable names. If None, range(N) is used.</li>
<li><strong>fig_ax</strong> (<em>tuple of figure and axis object</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Figure and axes instance. If None they are created.</li>
<li><strong>figsize</strong> (<em>tuple</em>) – Size of figure.</li>
<li><strong>sig_thres</strong> (<em>array-like</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Matrix of significance thresholds. Must be of same shape as  val_matrix.
Either sig_thres or link_matrix has to be provided.</li>
<li><strong>link_matrix</strong> (<em>bool array-like</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Matrix of significant links. Must be of same shape as val_matrix. Either
sig_thres or link_matrix has to be provided.</li>
<li><strong>save_name</strong> (<em>str</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Name of figure file to save figure. If None, figure is shown in window.</li>
<li><strong>link_colorbar_label</strong> (<em>str</em><em>, </em><em>optional</em><em> (</em><em>default: 'MCI'</em><em>)</em>) – Test statistic label.</li>
<li><strong>node_colorbar_label</strong> (<em>str</em><em>, </em><em>optional</em><em> (</em><em>default: 'auto-MCI'</em><em>)</em>) – Test statistic label for auto-dependencies.</li>
<li><strong>link_width</strong> (<em>array-like</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Array of val_matrix.shape specifying relative link width with maximum
given by arrow_linewidth. If None, all links have same width.</li>
<li><strong>link_attribute</strong> (<em>array-like</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – String array of val_matrix.shape specifying link attributes.</li>
<li><strong>node_pos</strong> (<em>dictionary</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Dictionary of node positions in axis coordinates of form
node_pos = {‘x’:array of shape (N,), ‘y’:array of shape(N)}. These
coordinates could have been transformed before for basemap plots.</li>
<li><strong>arrow_linewidth</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 30</em><em>)</em>) – Linewidth.</li>
<li><strong>vmin_edges</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: -1</em><em>)</em>) – Link colorbar scale lower bound.</li>
<li><strong>vmax_edges</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 1</em><em>)</em>) – Link colorbar scale upper bound.</li>
<li><strong>edge_ticks</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 0.4</em><em>)</em>) – Link tick mark interval.</li>
<li><strong>cmap_edges</strong> (<em>str</em><em>, </em><em>optional</em><em> (</em><em>default: 'RdBu_r'</em><em>)</em>) – Colormap for links.</li>
<li><strong>vmin_nodes</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 0</em><em>)</em>) – Node colorbar scale lower bound.</li>
<li><strong>vmax_nodes</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 1</em><em>)</em>) – Node colorbar scale upper bound.</li>
<li><strong>node_ticks</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 0.4</em><em>)</em>) – Node tick mark interval.</li>
<li><strong>cmap_nodes</strong> (<em>str</em><em>, </em><em>optional</em><em> (</em><em>default: 'OrRd'</em><em>)</em>) – Colormap for links.</li>
<li><strong>node_size</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 20</em><em>)</em>) – Node size.</li>
<li><strong>arrowhead_size</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 20</em><em>)</em>) – Size of link arrow head. Passed on to FancyArrowPatch object.</li>
<li><strong>float</strong><strong>, </strong><strong>optional</strong><strong> (</strong><strong>default</strong> (<em>curved_radius</em><em>,</em>) – Curvature of links. Passed on to FancyArrowPatch object.</li>
<li><strong>label_fontsize</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 10</em><em>)</em>) – Fontsize of colorbar labels.</li>
<li><strong>alpha</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 1.</em><em>)</em>) – Opacity.</li>
<li><strong>node_label_size</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 10</em><em>)</em>) – Fontsize of node labels.</li>
<li><strong>link_label_fontsize</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 6</em><em>)</em>) – Fontsize of link labels.</li>
<li><strong>lag_array</strong> (<em>array</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Optional specification of lags overwriting np.arange(0, tau_max+1)</li>
<li><strong>network_lower_bound</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 0.2</em><em>)</em>) – Fraction of vertical space below graph plot.</li>
<li><strong>show_colorbar</strong> (<em>bool</em>) – Whether to show colorbars for links and nodes.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tigramite.plotting.plot_lagfuncs">
<code class="descclassname">tigramite.plotting.</code><code class="descname">plot_lagfuncs</code><span class="sig-paren">(</span><em>val_matrix</em>, <em>name=None</em>, <em>setup_args={}</em>, <em>add_lagfunc_args={}</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.plotting.plot_lagfuncs" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper helper function to plot lag functions.</p>
<p>Sets up the matrix object and plots the lagfunction, see parameters in setup_matrix
and add_lagfuncs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>val_matrix</strong> (<em>array_like</em>) – Matrix of shape (N, N, tau_max+1) containing test statistic values.</li>
<li><strong>name</strong> (<em>str</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – File name. If None, figure is shown in window.</li>
<li><strong>setup_args</strong> (<em>dict</em>) – Arguments for setting up the lag function matrix, see doc of
setup_matrix.</li>
<li><strong>add_lagfunc_args</strong> (<em>dict</em>) – Arguments for adding a lag function matrix, see doc of add_lagfuncs.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>matrix</strong> – Further lag functions can be overlaid using the matrix.add_lagfuncs(val_matrix)
function.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">object</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tigramite.plotting.plot_mediation_graph">
<code class="descclassname">tigramite.plotting.</code><code class="descname">plot_mediation_graph</code><span class="sig-paren">(</span><em>path_val_matrix</em>, <em>path_node_array=None</em>, <em>var_names=None</em>, <em>fig_ax=None</em>, <em>figsize=None</em>, <em>save_name=None</em>, <em>link_colorbar_label='link coeff. (edge color)'</em>, <em>node_colorbar_label='MCE (node color)'</em>, <em>link_width=None</em>, <em>node_pos=None</em>, <em>arrow_linewidth=30.0</em>, <em>vmin_edges=-1</em>, <em>vmax_edges=1.0</em>, <em>edge_ticks=0.4</em>, <em>cmap_edges='RdBu_r'</em>, <em>vmin_nodes=-1.0</em>, <em>vmax_nodes=1.0</em>, <em>node_ticks=0.4</em>, <em>cmap_nodes='RdBu_r'</em>, <em>node_size=20</em>, <em>arrowhead_size=20</em>, <em>curved_radius=0.2</em>, <em>label_fontsize=10</em>, <em>lag_array=None</em>, <em>alpha=1.0</em>, <em>node_label_size=10</em>, <em>link_label_fontsize=6</em>, <em>network_lower_bound=0.2</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.plotting.plot_mediation_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a network plot visualizing the pathways of a mediation analysis.</p>
<p>This is still in beta. The network is defined from non-zero entries in
<code class="docutils literal notranslate"><span class="pre">path_val_matrix</span></code>.  Nodes denote variables, straight links contemporaneous
dependencies and curved arrows lagged dependencies. The node color denotes
the mediated causal effect (MCE) and the link color the value at the lag
with maximal link coefficient. The link label lists the lags with
significant dependency in order of absolute magnitude. The network can also
be plotted over a map drawn before on the same axis. Then the node positions
can be supplied in appropriate axis coordinates via node_pos.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>path_val_matrix</strong> (<em>array_like</em>) – Matrix of shape (N, N, tau_max+1) containing link weight values.</li>
<li><strong>path_node_array</strong> (<em>array_like</em>) – Array of shape (N,) containing node values.</li>
<li><strong>var_names</strong> (<em>list</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – List of variable names. If None, range(N) is used.</li>
<li><strong>fig_ax</strong> (<em>tuple of figure and axis object</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Figure and axes instance. If None they are created.</li>
<li><strong>figsize</strong> (<em>tuple</em>) – Size of figure.</li>
<li><strong>save_name</strong> (<em>str</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Name of figure file to save figure. If None, figure is shown in window.</li>
<li><strong>link_colorbar_label</strong> (<em>str</em><em>, </em><em>optional</em><em> (</em><em>default: 'link coeff.</em><em> (</em><em>edge color</em><em>)</em><em>'</em><em>)</em>) – Link colorbar label.</li>
<li><strong>node_colorbar_label</strong> (<em>str</em><em>, </em><em>optional</em><em> (</em><em>default: 'MCE</em><em> (</em><em>node color</em><em>)</em><em>'</em><em>)</em>) – Node colorbar label.</li>
<li><strong>link_width</strong> (<em>array-like</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Array of val_matrix.shape specifying relative link width with maximum
given by arrow_linewidth. If None, all links have same width.</li>
<li><strong>node_pos</strong> (<em>dictionary</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Dictionary of node positions in axis coordinates of form
node_pos = {‘x’:array of shape (N,), ‘y’:array of shape(N)}. These
coordinates could have been transformed before for basemap plots.</li>
<li><strong>arrow_linewidth</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 30</em><em>)</em>) – Linewidth.</li>
<li><strong>vmin_edges</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: -1</em><em>)</em>) – Link colorbar scale lower bound.</li>
<li><strong>vmax_edges</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 1</em><em>)</em>) – Link colorbar scale upper bound.</li>
<li><strong>edge_ticks</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 0.4</em><em>)</em>) – Link tick mark interval.</li>
<li><strong>cmap_edges</strong> (<em>str</em><em>, </em><em>optional</em><em> (</em><em>default: 'RdBu_r'</em><em>)</em>) – Colormap for links.</li>
<li><strong>vmin_nodes</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 0</em><em>)</em>) – Node colorbar scale lower bound.</li>
<li><strong>vmax_nodes</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 1</em><em>)</em>) – Node colorbar scale upper bound.</li>
<li><strong>node_ticks</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 0.4</em><em>)</em>) – Node tick mark interval.</li>
<li><strong>cmap_nodes</strong> (<em>str</em><em>, </em><em>optional</em><em> (</em><em>default: 'OrRd'</em><em>)</em>) – Colormap for links.</li>
<li><strong>node_size</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 20</em><em>)</em>) – Node size.</li>
<li><strong>arrowhead_size</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 20</em><em>)</em>) – Size of link arrow head. Passed on to FancyArrowPatch object.</li>
<li><strong>float</strong><strong>, </strong><strong>optional</strong><strong> (</strong><strong>default</strong> (<em>curved_radius</em><em>,</em>) – Curvature of links. Passed on to FancyArrowPatch object.</li>
<li><strong>label_fontsize</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 10</em><em>)</em>) – Fontsize of colorbar labels.</li>
<li><strong>alpha</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 1.</em><em>)</em>) – Opacity.</li>
<li><strong>node_label_size</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 10</em><em>)</em>) – Fontsize of node labels.</li>
<li><strong>link_label_fontsize</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 6</em><em>)</em>) – Fontsize of link labels.</li>
<li><strong>network_lower_bound</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 0.2</em><em>)</em>) – Fraction of vertical space below graph plot.</li>
<li><strong>lag_array</strong> (<em>array</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Optional specification of lags overwriting np.arange(0, tau_max+1)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tigramite.plotting.plot_mediation_time_series_graph">
<code class="descclassname">tigramite.plotting.</code><code class="descname">plot_mediation_time_series_graph</code><span class="sig-paren">(</span><em>path_node_array</em>, <em>tsg_path_val_matrix</em>, <em>var_names=None</em>, <em>fig_ax=None</em>, <em>figsize=None</em>, <em>link_colorbar_label='link coeff. (edge color)'</em>, <em>node_colorbar_label='MCE (node color)'</em>, <em>save_name=None</em>, <em>link_width=None</em>, <em>arrow_linewidth=20.0</em>, <em>vmin_edges=-1</em>, <em>vmax_edges=1.0</em>, <em>edge_ticks=0.4</em>, <em>cmap_edges='RdBu_r'</em>, <em>order=None</em>, <em>vmin_nodes=-1.0</em>, <em>vmax_nodes=1.0</em>, <em>node_ticks=0.4</em>, <em>cmap_nodes='RdBu_r'</em>, <em>node_size=10</em>, <em>arrowhead_size=20</em>, <em>curved_radius=0.2</em>, <em>label_fontsize=10</em>, <em>alpha=1.0</em>, <em>node_label_size=10</em>, <em>label_space_left=0.1</em>, <em>label_space_top=0.0</em>, <em>network_lower_bound=0.2</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.plotting.plot_mediation_time_series_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a mediation time series graph plot.</p>
<p>This is still in beta. The time series graph’s links are colored by
val_matrix.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>tsg_path_val_matrix</strong> (<em>array_like</em>) – Matrix of shape (N*tau_max, N*tau_max) containing link weight values.</li>
<li><strong>path_node_array</strong> (<em>array_like</em>) – Array of shape (N,) containing node values.</li>
<li><strong>var_names</strong> (<em>list</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – List of variable names. If None, range(N) is used.</li>
<li><strong>fig_ax</strong> (<em>tuple of figure and axis object</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Figure and axes instance. If None they are created.</li>
<li><strong>figsize</strong> (<em>tuple</em>) – Size of figure.</li>
<li><strong>save_name</strong> (<em>str</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Name of figure file to save figure. If None, figure is shown in window.</li>
<li><strong>link_colorbar_label</strong> (<em>str</em><em>, </em><em>optional</em><em> (</em><em>default: 'link coeff.</em><em> (</em><em>edge color</em><em>)</em><em>'</em><em>)</em>) – Link colorbar label.</li>
<li><strong>node_colorbar_label</strong> (<em>str</em><em>, </em><em>optional</em><em> (</em><em>default: 'MCE</em><em> (</em><em>node color</em><em>)</em><em>'</em><em>)</em>) – Node colorbar label.</li>
<li><strong>link_width</strong> (<em>array-like</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Array of val_matrix.shape specifying relative link width with maximum
given by arrow_linewidth. If None, all links have same width.</li>
<li><strong>order</strong> (<em>list</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – order of variables from top to bottom.</li>
<li><strong>arrow_linewidth</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 30</em><em>)</em>) – Linewidth.</li>
<li><strong>vmin_edges</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: -1</em><em>)</em>) – Link colorbar scale lower bound.</li>
<li><strong>vmax_edges</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 1</em><em>)</em>) – Link colorbar scale upper bound.</li>
<li><strong>edge_ticks</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 0.4</em><em>)</em>) – Link tick mark interval.</li>
<li><strong>cmap_edges</strong> (<em>str</em><em>, </em><em>optional</em><em> (</em><em>default: 'RdBu_r'</em><em>)</em>) – Colormap for links.</li>
<li><strong>vmin_nodes</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 0</em><em>)</em>) – Node colorbar scale lower bound.</li>
<li><strong>vmax_nodes</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 1</em><em>)</em>) – Node colorbar scale upper bound.</li>
<li><strong>node_ticks</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 0.4</em><em>)</em>) – Node tick mark interval.</li>
<li><strong>cmap_nodes</strong> (<em>str</em><em>, </em><em>optional</em><em> (</em><em>default: 'OrRd'</em><em>)</em>) – Colormap for links.</li>
<li><strong>node_size</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 20</em><em>)</em>) – Node size.</li>
<li><strong>arrowhead_size</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 20</em><em>)</em>) – Size of link arrow head. Passed on to FancyArrowPatch object.</li>
<li><strong>float</strong><strong>, </strong><strong>optional</strong><strong> (</strong><strong>default</strong> (<em>curved_radius</em><em>,</em>) – Curvature of links. Passed on to FancyArrowPatch object.</li>
<li><strong>label_fontsize</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 10</em><em>)</em>) – Fontsize of colorbar labels.</li>
<li><strong>alpha</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 1.</em><em>)</em>) – Opacity.</li>
<li><strong>node_label_size</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 10</em><em>)</em>) – Fontsize of node labels.</li>
<li><strong>link_label_fontsize</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 6</em><em>)</em>) – Fontsize of link labels.</li>
<li><strong>label_space_left</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 0.1</em><em>)</em>) – Fraction of horizontal figure space to allocate left of plot for labels.</li>
<li><strong>label_space_top</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 0.</em><em>)</em>) – Fraction of vertical figure space to allocate top of plot for labels.</li>
<li><strong>network_lower_bound</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 0.2</em><em>)</em>) – Fraction of vertical space below graph plot.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tigramite.plotting.plot_time_series_graph">
<code class="descclassname">tigramite.plotting.</code><code class="descname">plot_time_series_graph</code><span class="sig-paren">(</span><em>val_matrix</em>, <em>var_names=None</em>, <em>fig_ax=None</em>, <em>figsize=None</em>, <em>sig_thres=None</em>, <em>link_matrix=None</em>, <em>link_colorbar_label='MCI'</em>, <em>save_name=None</em>, <em>link_width=None</em>, <em>arrow_linewidth=20.0</em>, <em>vmin_edges=-1</em>, <em>vmax_edges=1.0</em>, <em>edge_ticks=0.4</em>, <em>cmap_edges='RdBu_r'</em>, <em>order=None</em>, <em>node_size=10</em>, <em>arrowhead_size=20</em>, <em>curved_radius=0.2</em>, <em>label_fontsize=10</em>, <em>alpha=1.0</em>, <em>node_label_size=10</em>, <em>label_space_left=0.1</em>, <em>label_space_top=0.0</em>, <em>network_lower_bound=0.2</em>, <em>undirected_style='dashed'</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.plotting.plot_time_series_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a time series graph.</p>
<p>This is still in beta. The time series graph’s links are colored by
val_matrix.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>val_matrix</strong> (<em>array_like</em>) – Matrix of shape (N, N, tau_max+1) containing test statistic values.</li>
<li><strong>var_names</strong> (<em>list</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – List of variable names. If None, range(N) is used.</li>
<li><strong>fig_ax</strong> (<em>tuple of figure and axis object</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Figure and axes instance. If None they are created.</li>
<li><strong>figsize</strong> (<em>tuple</em>) – Size of figure.</li>
<li><strong>sig_thres</strong> (<em>array-like</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Matrix of significance thresholds. Must be of same shape as  val_matrix.
Either sig_thres or link_matrix has to be provided.</li>
<li><strong>link_matrix</strong> (<em>bool array-like</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Matrix of significant links. Must be of same shape as val_matrix. Either
sig_thres or link_matrix has to be provided.</li>
<li><strong>save_name</strong> (<em>str</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Name of figure file to save figure. If None, figure is shown in window.</li>
<li><strong>link_colorbar_label</strong> (<em>str</em><em>, </em><em>optional</em><em> (</em><em>default: 'MCI'</em><em>)</em>) – Test statistic label.</li>
<li><strong>link_width</strong> (<em>array-like</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Array of val_matrix.shape specifying relative link width with maximum
given by arrow_linewidth. If None, all links have same width.</li>
<li><strong>order</strong> (<em>list</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – </li>
<li><strong>of variables from top to bottom.</strong> (<em>order</em>) – </li>
<li><strong>arrow_linewidth</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 30</em><em>)</em>) – Linewidth.</li>
<li><strong>vmin_edges</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: -1</em><em>)</em>) – Link colorbar scale lower bound.</li>
<li><strong>vmax_edges</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 1</em><em>)</em>) – Link colorbar scale upper bound.</li>
<li><strong>edge_ticks</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 0.4</em><em>)</em>) – Link tick mark interval.</li>
<li><strong>cmap_edges</strong> (<em>str</em><em>, </em><em>optional</em><em> (</em><em>default: 'RdBu_r'</em><em>)</em>) – Colormap for links.</li>
<li><strong>node_size</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 20</em><em>)</em>) – Node size.</li>
<li><strong>arrowhead_size</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 20</em><em>)</em>) – Size of link arrow head. Passed on to FancyArrowPatch object.</li>
<li><strong>float</strong><strong>, </strong><strong>optional</strong><strong> (</strong><strong>default</strong> (<em>curved_radius</em><em>,</em>) – Curvature of links. Passed on to FancyArrowPatch object.</li>
<li><strong>label_fontsize</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 10</em><em>)</em>) – Fontsize of colorbar labels.</li>
<li><strong>alpha</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 1.</em><em>)</em>) – Opacity.</li>
<li><strong>node_label_size</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 10</em><em>)</em>) – Fontsize of node labels.</li>
<li><strong>link_label_fontsize</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 6</em><em>)</em>) – Fontsize of link labels.</li>
<li><strong>label_space_left</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 0.1</em><em>)</em>) – Fraction of horizontal figure space to allocate left of plot for labels.</li>
<li><strong>label_space_top</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 0.</em><em>)</em>) – Fraction of vertical figure space to allocate top of plot for labels.</li>
<li><strong>network_lower_bound</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 0.2</em><em>)</em>) – Fraction of vertical space below graph plot.</li>
<li><strong>undirected_style</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default: 'dashed'</em><em>)</em>) – Style of undirected contemporaneous links.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tigramite.plotting.plot_timeseries">
<code class="descclassname">tigramite.plotting.</code><code class="descname">plot_timeseries</code><span class="sig-paren">(</span><em>dataframe=None</em>, <em>save_name=None</em>, <em>fig_axes=None</em>, <em>figsize=None</em>, <em>var_units=None</em>, <em>time_label='time'</em>, <em>use_mask=False</em>, <em>grey_masked_samples=False</em>, <em>data_linewidth=1.0</em>, <em>skip_ticks_data_x=1</em>, <em>skip_ticks_data_y=2</em>, <em>label_fontsize=8</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.plotting.plot_timeseries" title="Permalink to this definition">¶</a></dt>
<dd><p>Create and save figure of stacked panels with time series.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dataframe</strong> (<em>data object</em><em>, </em><em>optional</em>) – This is the Tigramite dataframe object. It has the attributes
dataframe.values yielding a np array of shape (observations T,
variables N) and optionally a mask of the same shape.</li>
<li><strong>save_name</strong> (<em>str</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Name of figure file to save figure. If None, figure is shown in window.</li>
<li><strong>fig_axes</strong> (<em>subplots instance</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Figure and axes instance. If None they are created as
fig, axes = pyplot.subplots(N,…)</li>
<li><strong>figsize</strong> (<em>tuple of floats</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Figure size if new figure is created. If None, default pyplot figsize
is used.</li>
<li><strong>var_units</strong> (<em>list of str</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Units of variables.</li>
<li><strong>time_label</strong> (<em>str</em><em>, </em><em>optional</em><em> (</em><em>default: ''</em><em>)</em>) – Label of time axis.</li>
<li><strong>use_mask</strong> (<em>bool</em><em>, </em><em>optional</em><em> (</em><em>default: False</em><em>)</em>) – Whether to use masked data.</li>
<li><strong>grey_masked_samples</strong> (<em>bool</em><em>, </em><em>optional</em><em> (</em><em>default: False</em><em>)</em>) – Whether to mark masked samples by grey fills (‘fill’) or grey data (‘data’).</li>
<li><strong>data_linewidth</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 1.</em><em>)</em>) – Linewidth.</li>
<li><strong>skip_ticks_data_x</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 1</em><em>)</em>) – Skip every other tickmark.</li>
<li><strong>skip_ticks_data_y</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 2</em><em>)</em>) – Skip every other tickmark.</li>
<li><strong>label_fontsize</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 10</em><em>)</em>) – Fontsize of variable labels.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="tigramite.plotting.setup_matrix">
<em class="property">class </em><code class="descclassname">tigramite.plotting.</code><code class="descname">setup_matrix</code><span class="sig-paren">(</span><em>N</em>, <em>tau_max</em>, <em>var_names=None</em>, <em>figsize=None</em>, <em>minimum=-1</em>, <em>maximum=1</em>, <em>label_space_left=0.1</em>, <em>label_space_top=0.05</em>, <em>legend_width=0.15</em>, <em>legend_fontsize=10</em>, <em>x_base=1.0</em>, <em>y_base=0.5</em>, <em>plot_gridlines=False</em>, <em>lag_units=''</em>, <em>lag_array=None</em>, <em>label_fontsize=10</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.plotting.setup_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Create matrix of lag function panels.</p>
<p>Class to setup figure object. The function add_lagfuncs(…) allows to plot
the val_matrix of shape (N, N, tau_max+1). Multiple lagfunctions can be
overlaid for comparison.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>N</strong> (<em>int</em>) – Number of variables</li>
<li><strong>tau_max</strong> (<em>int</em>) – Maximum time lag.</li>
<li><strong>var_names</strong> (<em>list</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – List of variable names. If None, range(N) is used.</li>
<li><strong>figsize</strong> (<em>tuple of floats</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Figure size if new figure is created. If None, default pyplot figsize
is used.</li>
<li><strong>minimum</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: -1</em><em>)</em>) – Lower y-axis limit.</li>
<li><strong>maximum</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 1</em><em>)</em>) – Upper y-axis limit.</li>
<li><strong>label_space_left</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 0.1</em><em>)</em>) – Fraction of horizontal figure space to allocate left of plot for labels.</li>
<li><strong>label_space_top</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 0.05</em><em>)</em>) – Fraction of vertical figure space to allocate top of plot for labels.</li>
<li><strong>legend_width</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 0.15</em><em>)</em>) – Fraction of horizontal figure space to allocate right of plot for
legend.</li>
<li><strong>x_base</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 1.</em><em>)</em>) – x-tick intervals to show.</li>
<li><strong>y_base</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: .4</em><em>)</em>) – y-tick intervals to show.</li>
<li><strong>plot_gridlines</strong> (<em>bool</em><em>, </em><em>optional</em><em> (</em><em>default: False</em><em>)</em>) – Whether to show a grid.</li>
<li><strong>lag_units</strong> (<em>str</em><em>, </em><em>optional</em><em> (</em><em>default: ''</em><em>)</em>) – </li>
<li><strong>lag_array</strong> (<em>array</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Optional specification of lags overwriting np.arange(0, tau_max+1)</li>
<li><strong>label_fontsize</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 10</em><em>)</em>) – Fontsize of variable labels.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tigramite.plotting.setup_matrix.add_lagfuncs">
<code class="descname">add_lagfuncs</code><span class="sig-paren">(</span><em>val_matrix</em>, <em>sig_thres=None</em>, <em>conf_matrix=None</em>, <em>color='black'</em>, <em>label=None</em>, <em>two_sided_thres=True</em>, <em>marker='.'</em>, <em>markersize=5</em>, <em>alpha=1.0</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.plotting.setup_matrix.add_lagfuncs" title="Permalink to this definition">¶</a></dt>
<dd><p>Add lag function plot from val_matrix array.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>val_matrix</strong> (<em>array_like</em>) – Matrix of shape (N, N, tau_max+1) containing test statistic values.</li>
<li><strong>sig_thres</strong> (<em>array-like</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Matrix of significance thresholds. Must be of same shape as
val_matrix.</li>
<li><strong>conf_matrix</strong> (<em>array-like</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Matrix of shape (, N, tau_max+1, 2) containing confidence bounds.</li>
<li><strong>color</strong> (<em>str</em><em>, </em><em>optional</em><em> (</em><em>default: 'black'</em><em>)</em>) – Line color.</li>
<li><strong>label</strong> (<em>str</em>) – Test statistic label.</li>
<li><strong>two_sided_thres</strong> (<em>bool</em><em>, </em><em>optional</em><em> (</em><em>default: True</em><em>)</em>) – Whether to draw sig_thres for pos. and neg. values.</li>
<li><strong>marker</strong> (<em>matplotlib marker symbol</em><em>, </em><em>optional</em><em> (</em><em>default: '.'</em><em>)</em>) – Marker.</li>
<li><strong>markersize</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 5</em><em>)</em>) – Marker size.</li>
<li><strong>alpha</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 1.</em><em>)</em>) – Opacity.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tigramite.plotting.setup_matrix.savefig">
<code class="descname">savefig</code><span class="sig-paren">(</span><em>name=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tigramite.plotting.setup_matrix.savefig" title="Permalink to this definition">¶</a></dt>
<dd><p>Save matrix figure.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> (<em>str</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – File name. If None, figure is shown in window.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></li>
<li><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></li>
<li><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></li>
</ul>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="#">Tigramite 4.0 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Jakob Runge.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.4.
    </div>
  </body>
</html>